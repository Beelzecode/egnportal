<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#ffffff">
    <title>Illuminati Black Rituals - Premium Spiritual Products</title>
    <link rel="icon" href="https://i.postimg.cc/rwmPjzWr/IMG-2949.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href__="https://fonts.googleapis.com">
    <link rel="preconnect" href__="https://fonts.gstatic.com" crossorigin>
    <link href__="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>
    
    <style>
        * {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        
        body { 
            margin: 0; 
            padding: 0; 
            background: #ffffff;
            color: #000000;
        }
        
        .hidden { display: none !important; }
        
        .product-card { 
            background: #ffffff;
            border-radius: 20px; 
            overflow: hidden; 
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 2px solid #e5e7eb;
            cursor: pointer;
            position: relative;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
        
        .product-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.12);
            border-color: #d4af37;
        }
        
        .btn-primary { 
            background: linear-gradient(135deg, #d4af37 0%, #aa8b2e 100%); 
            color: #000; 
            padding: 14px 28px; 
            border: none; 
            border-radius: 12px; 
            font-weight: 700; 
            cursor: pointer; 
            transition: all 0.3s ease; 
            text-transform: uppercase; 
            letter-spacing: 1.2px;
            box-shadow: 0 4px 12px rgba(212, 175, 55, 0.25);
            font-size: 13px;
        }
        
        .btn-primary:hover { 
            background: linear-gradient(135deg, #aa8b2e 0%, #8b7424 100%); 
            transform: translateY(-2px); 
            box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4); 
        }
        
        .btn-secondary {
            background: #f3f4f6;
            color: #1f2937;
            padding: 12px 24px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-secondary:hover {
            background: #e5e7eb;
            border-color: #d4af37;
        }
        
        .input-field { 
            width: 100%; 
            padding: 14px 18px; 
            background: #f9fafb; 
            border: 2px solid #e5e7eb; 
            border-radius: 12px; 
            font-size: 15px; 
            transition: all 0.3s; 
            color: #000;
        }
        
        .input-field:focus { 
            outline: none; 
            border-color: #d4af37; 
            box-shadow: 0 0 0 4px rgba(212, 175, 55, 0.1); 
            background: #ffffff;
        }
        
        textarea.input-field { 
            min-height: 120px; 
            resize: vertical; 
        }
        
        .tab-button { 
            padding: 12px 24px; 
            background: #f9fafb; 
            border: 2px solid #e5e7eb; 
            border-radius: 12px; 
            cursor: pointer; 
            transition: all 0.3s; 
            margin-right: 10px; 
            font-weight: 600;
            color: #4b5563;
        }
        
        .tab-button.active { 
            background: linear-gradient(135deg, #d4af37 0%, #aa8b2e 100%);
            color: #000;
            border-color: #d4af37;
            box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
        }
        
        .toast {
            position: fixed;
            top: 24px;
            right: 24px;
            background: linear-gradient(135deg, #d4af37 0%, #aa8b2e 100%);
            color: #000;
            padding: 16px 24px;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.4);
            z-index: 9999;
            animation: slideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 700;
        }
        
        .toast.error { 
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
            color: #fff;
            box-shadow: 0 8px 25px rgba(220, 38, 38, 0.4);
        }
        
        @keyframes slideIn {
            from { transform: translateX(500px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(8px);
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            animation: fadeIn 0.3s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .modal-content {
            background: #ffffff;
            border: 2px solid #d4af37;
            border-radius: 24px;
            max-width: 1000px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
        }
        
        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .stat-card {
            background: #ffffff;
            border: 2px solid #e5e7eb;
            border-radius: 20px;
            padding: 24px;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
        
        .stat-card:hover {
            border-color: #d4af37;
            transform: translateY(-4px);
            box-shadow: 0 12px 24px rgba(212, 175, 55, 0.15);
        }
        
        .price-tag {
            font-size: 2rem;
            font-weight: 900;
            background: linear-gradient(135deg, #d4af37 0%, #ffd700 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .badge {
            display: inline-block;
            padding: 6px 14px;
            background: #fef3c7;
            border: 1px solid #d4af37;
            color: #92400e;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.8px;
        }
        
        .alert-box {
            background: #fef3c7;
            border: 2px solid #d4af37;
            border-radius: 12px;
            padding: 12px 16px;
            margin-top: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .alert-box i {
            color: #92400e;
        }
        
        .alert-box p {
            color: #92400e;
            font-size: 13px;
            font-weight: 600;
            margin: 0;
        }
        
        .image-gallery {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding: 8px 0;
        }
        
        .image-gallery img {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 8px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s;
        }
        
        .image-gallery img:hover {
            border-color: #d4af37;
            transform: scale(1.1);
        }
        
        .order-card {
            background: #ffffff;
            border: 2px solid #e5e7eb;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            transition: all 0.3s;
        }
        
        .order-card:hover {
            border-color: #d4af37;
            box-shadow: 0 8px 20px rgba(212, 175, 55, 0.15);
        }
        
        .order-card.completed {
            background: #f0fdf4;
            border-color: #86efac;
        }
        
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f3f4f6;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #d4af37;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #aa8b2e;
        }
    </style>
</head>

<body>
    <div id="app-container">
        <!-- Admin Panel -->
        <div id="admin-page" class="hidden min-h-screen p-6 bg-gray-50">
            <div class="max-w-7xl mx-auto">
                <div class="flex justify-between items-center mb-10">
                    <div>
                        <h1 class="text-5xl font-black text-gray-900 mb-2">Admin Dashboard</h1>
                        <p class="text-gray-600 text-lg">Manage Illuminati Black Rituals Store</p>
                    </div>
                    <button onclick="showPage('home')" class="btn-primary">
                        <i data-lucide="home" class="w-5 h-5 inline mr-2"></i>Back to Store
                    </button>
                </div>

                <!-- Statistics Dashboard -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-10">
                    <div class="stat-card">
                        <div class="flex items-center justify-between mb-4">
                            <i data-lucide="shopping-bag" class="w-10 h-10 text-yellow-600"></i>
                            <span class="text-sm text-gray-500">Total</span>
                        </div>
                        <div class="text-4xl font-black text-gray-900 mb-1" id="stat-products">0</div>
                        <div class="text-gray-600 text-sm font-semibold">Products</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="flex items-center justify-between mb-4">
                            <i data-lucide="users" class="w-10 h-10 text-yellow-600"></i>
                            <span class="text-sm text-gray-500">Total</span>
                        </div>
                        <div class="text-4xl font-black text-gray-900 mb-1" id="stat-customers">0</div>
                        <div class="text-gray-600 text-sm font-semibold">Customers</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="flex items-center justify-between mb-4">
                            <i data-lucide="package" class="w-10 h-10 text-yellow-600"></i>
                            <span class="text-sm text-gray-500">All Time</span>
                        </div>
                        <div class="text-4xl font-black text-gray-900 mb-1" id="stat-orders">0</div>
                        <div class="text-gray-600 text-sm font-semibold">Orders</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="flex items-center justify-between mb-4">
                            <i data-lucide="dollar-sign" class="w-10 h-10 text-yellow-600"></i>
                            <span class="text-sm text-gray-500">Total Revenue</span>
                        </div>
                        <div class="text-4xl font-black text-gray-900 mb-1" id="stat-revenue">R 0</div>
                        <div class="text-gray-600 text-sm font-semibold">Revenue</div>
                    </div>
                </div>

                <!-- Charts -->
                <div class="grid md:grid-cols-2 gap-6 mb-10">
                    <div class="stat-card">
                        <h3 class="text-xl font-bold text-gray-900 mb-6">Orders Over Time</h3>
                        <div style="position: relative; height: 300px;">
                            <canvas id="salesChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <h3 class="text-xl font-bold text-gray-900 mb-6">Product Categories</h3>
                        <div style="position: relative; height: 300px;">
                            <canvas id="categoryChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Admin Tabs -->
                <div class="mb-8">
                    <div class="flex flex-wrap gap-4">
                        <button onclick="showAdminTab('products')" id="admin-tab-products" class="tab-button active">
                            <i data-lucide="shopping-bag" class="w-5 h-5 inline mr-2"></i>Manage Products
                        </button>
                        <button onclick="showAdminTab('orders')" id="admin-tab-orders" class="tab-button">
                            <i data-lucide="clipboard-list" class="w-5 h-5 inline mr-2"></i>Orders
                        </button>
                        <button onclick="showAdminTab('testimonials')" id="admin-tab-testimonials" class="tab-button">
                            <i data-lucide="message-square" class="w-5 h-5 inline mr-2"></i>Testimonials
                        </button>
                        <button onclick="showAdminTab('settings')" id="admin-tab-settings" class="tab-button">
                            <i data-lucide="settings" class="w-5 h-5 inline mr-2"></i>Settings
                        </button>
                    </div>
                </div>

                <!-- Products Tab -->
                <div id="admin-content-products" class="admin-content">
                    <div class="stat-card p-8">
                        <h2 class="text-3xl font-bold text-gray-900 mb-8 flex items-center gap-4">
                            <i data-lucide="plus-circle" class="w-8 h-8 text-yellow-600"></i>
                            Add New Product
                        </h2>
                        
                        <div class="grid md:grid-cols-2 gap-8 mb-8">
                            <div class="space-y-5">
                                <div>
                                    <label class="block text-sm font-bold mb-3 text-gray-700 uppercase tracking-wide">Product Name *</label>
                                    <input id="new-product-name" placeholder="e.g., Black Sage Bundle" class="input-field">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-bold mb-3 text-gray-700 uppercase tracking-wide">Price (R) *</label>
                                    <input id="new-product-price" type="number" placeholder="e.g., 450" class="input-field">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-bold mb-3 text-gray-700 uppercase tracking-wide">Category *</label>
                                    <select id="new-product-category" class="input-field">
                                        <option value="herbs">Sacred Herbs</option>
                                        <option value="crystals">Crystals & Stones</option>
                                        <option value="rituals">Ritual Kits</option>
                                        <option value="oils">Essential Oils</option>
                                        <option value="candles">Ritual Candles</option>
                                        <option value="protection">Protection Items</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-bold mb-3 text-gray-700 uppercase tracking-wide">Upload Product Images *</label>
                                    <input id="new-product-images" type="file" multiple accept="image/*" class="input-field">
                                    <p class="text-xs text-gray-500 mt-2">You can select multiple images</p>
                                    <div id="image-preview" class="mt-4 flex gap-2 flex-wrap"></div>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-bold mb-3 text-gray-700 uppercase tracking-wide">Contact Phone *</label>
                                    <input id="new-product-phone" placeholder="+27 XX XXX XXXX" class="input-field">
                                </div>
                            </div>
                            
                            <div class="space-y-5">
                                <div>
                                    <label class="block text-sm font-bold mb-3 text-gray-700 uppercase tracking-wide">Short Description *</label>
                                    <textarea id="new-product-description" placeholder="Brief description..." class="input-field" rows="3"></textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-bold mb-3 text-gray-700 uppercase tracking-wide">Full Details *</label>
                                    <textarea id="new-product-details" placeholder="Detailed information about benefits, origin, energy properties..." class="input-field" rows="6"></textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-bold mb-3 text-gray-700 uppercase tracking-wide">Usage Instructions *</label>
                                    <textarea id="new-product-instructions" placeholder="Step by step instructions..." class="input-field" rows="6"></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <button onclick="addProduct()" id="add-product-btn" class="btn-primary w-full text-lg py-5">
                            <i data-lucide="plus" class="w-6 h-6 inline mr-2"></i>Add Product to Store
                        </button>
                        
                        <div class="mt-12">
                            <h3 class="text-2xl font-bold text-gray-900 mb-6">All Products</h3>
                            <div id="admin-products-list" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
                        </div>
                    </div>
                </div>

                <!-- Orders Tab -->
                <div id="admin-content-orders" class="admin-content hidden">
                    <div class="stat-card p-8">
                        <h2 class="text-3xl font-bold text-gray-900 mb-8">Order Management</h2>
                        <div id="orders-list"></div>
                    </div>
                </div>

                <!-- Testimonials Tab -->
                <div id="admin-content-testimonials" class="admin-content hidden">
                    <div class="stat-card p-8">
                        <h2 class="text-3xl font-bold text-gray-900 mb-8">Manage Testimonials</h2>
                        
                        <div class="grid md:grid-cols-2 gap-8 mb-8">
                            <div class="space-y-5">
                                <h3 class="text-xl font-bold text-yellow-600">Add New Testimonial</h3>
                                <input id="new-testimonial-name" placeholder="Customer Name" class="input-field">
                                <input id="new-testimonial-title" placeholder="e.g., Energy Healer" class="input-field">
                                <textarea id="new-testimonial-quote" placeholder="Testimonial text..." class="input-field" rows="4"></textarea>
                                <input id="new-testimonial-image" type="file" accept="image/*" class="input-field">
                                <button onclick="addTestimonial()" class="btn-primary w-full">
                                    <i data-lucide="plus-circle" class="w-5 h-5 inline mr-2"></i>Add Testimonial
                                </button>
                            </div>
                            
                            <div>
                                <h3 class="text-xl font-bold text-yellow-600 mb-4">Current Testimonials</h3>
                                <div id="testimonials-admin-list" class="space-y-4"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Settings Tab -->
                <div id="admin-content-settings" class="admin-content hidden">
                    <div class="stat-card p-8">
                        <h2 class="text-3xl font-bold text-gray-900 mb-8">Store Settings</h2>
                        <div class="space-y-6 max-w-2xl">
                            <div>
                                <label class="block text-sm font-bold mb-3 text-gray-700 uppercase tracking-wide">Store Email</label>
                                <input id="shop-email" type="email" value="illuminatiblackrituals@gmail.com" class="input-field">
                            </div>
                            <div>
                                <label class="block text-sm font-bold mb-3 text-gray-700 uppercase tracking-wide">Contact Phone</label>
                                <input id="shop-phone" value="+27 XX XXX XXXX" class="input-field">
                            </div>
                            <div>
                                <label class="block text-sm font-bold mb-3 text-gray-700 uppercase tracking-wide">Bank Details</label>
                                <textarea id="bank-details" class="input-field" rows="3">TymeBank Everyday Account: 5110 3334 333</textarea>
                            </div>
                            <div>
                                <label class="block text-sm font-bold mb-3 text-gray-700 uppercase tracking-wide">Footer Text</label>
                                <input id="footer-text" value="© 2024 Illuminati Black Rituals - Premium Spiritual Products" class="input-field">
                            </div>
                            <button onclick="saveSettings()" class="btn-primary w-full">
                                <i data-lucide="save" class="w-5 h-5 inline mr-2"></i>Save All Settings
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Home / Shop Page -->
        <div id="home-page">
            <!-- Navigation Header -->
            <header class="sticky top-0 z-50 bg-white shadow-md">
                <div class="container mx-auto px-6 py-5">
                    <div class="flex justify-between items-center">
                        <div class="flex items-center gap-4">
                            <img src="https://i.postimg.cc/rwmPjzWr/IMG-2949.png" 
                                 alt="Logo" class="w-14 h-14 object-contain">
                            <div>
                                <h1 class="text-2xl md:text-3xl font-black text-gray-900">ILLUMINATI BLACK RITUALS</h1>
                                <p class="text-xs text-gray-600 tracking-wider uppercase">Premium Spiritual Products</p>
                            </div>
                        </div>
                        <button onclick="showAdminLogin()" class="btn-secondary px-6 py-3">
                            <i data-lucide="user" class="w-5 h-5 inline mr-2"></i>Admin
                        </button>
                    </div>
                </div>
            </header>

            <!-- Hero Section -->
            <div class="bg-gradient-to-br from-gray-50 to-gray-100 py-20">
                <div class="container mx-auto px-6 text-center">
                    <h2 class="text-5xl md:text-6xl font-black text-gray-900 mb-6 leading-tight">
                        Ancient Wisdom<br/>
                        <span class="text-transparent bg-clip-text bg-gradient-to-r from-yellow-600 to-yellow-500">Modern Power</span>
                    </h2>
                    <p class="text-xl text-gray-700 max-w-3xl mx-auto mb-10 leading-relaxed">
                        Discover our exclusive collection of sacred herbs, powerful crystals, and mystical ritual kits. 
                        Each product is carefully selected and energetically charged for maximum spiritual potency.
                    </p>
                    <div class="flex flex-wrap justify-center gap-8">
                        <div class="flex items-center gap-3">
                            <div class="w-14 h-14 rounded-full bg-gradient-to-br from-yellow-500 to-yellow-600 flex items-center justify-center shadow-lg">
                                <i data-lucide="shield-check" class="w-7 h-7 text-white"></i>
                            </div>
                            <div class="text-left">
                                <div class="font-bold text-gray-900">100% Authentic</div>
                                <div class="text-gray-600 text-sm">Ethically Sourced</div>
                            </div>
                        </div>
                        <div class="flex items-center gap-3">
                            <div class="w-14 h-14 rounded-full bg-gradient-to-br from-yellow-500 to-yellow-600 flex items-center justify-center shadow-lg">
                                <i data-lucide="zap" class="w-7 h-7 text-white"></i>
                            </div>
                            <div class="text-left">
                                <div class="font-bold text-gray-900">Energetically Charged</div>
                                <div class="text-gray-600 text-sm">Moon-Blessed</div>
                            </div>
                        </div>
                        <div class="flex items-center gap-3">
                            <div class="w-14 h-14 rounded-full bg-gradient-to-br from-yellow-500 to-yellow-600 flex items-center justify-center shadow-lg">
                                <i data-lucide="lock" class="w-7 h-7 text-white"></i>
                            </div>
                            <div class="text-left">
                                <div class="font-bold text-gray-900">Secure Checkout</div>
                                <div class="text-gray-600 text-sm">PayFast Protected</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Products Section -->
            <div class="py-20 bg-white">
                <div class="container mx-auto px-6">
                    <div class="text-center mb-16">
                        <h2 class="text-5xl font-black text-gray-900 mb-4">Our Sacred Collection</h2>
                        <p class="text-gray-600 text-lg">Click any product to view full details and images</p>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8" id="products-grid"></div>
                </div>
            </div>

            <!-- Testimonials Section -->
            <div class="py-20 bg-gray-50">
                <div class="container mx-auto px-6">
                    <div class="text-center mb-16">
                        <h2 class="text-5xl font-black text-gray-900 mb-4">Customer Experiences</h2>
                        <p class="text-gray-600 text-lg">Real stories from our spiritual community</p>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="testimonials-grid"></div>
                </div>
            </div>

            <!-- Protection Section -->
            <div class="py-20 bg-white">
                <div class="container mx-auto px-6">
                    <div class="max-w-4xl mx-auto stat-card p-12 text-center">
                        <i data-lucide="shield" class="w-20 h-20 text-yellow-600 mx-auto mb-6"></i>
                        <h3 class="text-4xl font-black text-gray-900 mb-6">Spiritual Protection Guarantee</h3>
                        <p class="text-gray-700 leading-relaxed text-lg mb-6">
                            Every product in our collection is ethically sourced, energetically cleansed, and blessed under the full moon. 
                            We protect your spiritual journey with ancient wards and modern security. Your privacy is sacred to us.
                        </p>
                        <p class="text-gray-600 text-sm">
                            All transactions are secured through encrypted PayFast payment gateway. 
                            Your personal information is protected with bank-level security.
                        </p>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <footer class="bg-gray-900 text-white py-12">
                <div class="container mx-auto px-6">
                    <div class="grid md:grid-cols-3 gap-12 mb-8">
                        <div>
                            <h4 class="text-xl font-black mb-4">ILLUMINATI BLACK RITUALS</h4>
                            <p class="text-gray-400 text-sm leading-relaxed">
                                Your trusted source for authentic spiritual products. 
                                Serving the community with integrity and power.
                            </p>
                        </div>
                        <div>
                            <h4 class="text-lg font-bold mb-4">Contact Us</h4>
                            <div class="space-y-3 text-gray-400 text-sm">
                                <div class="flex items-center gap-3">
                                    <i data-lucide="mail" class="w-5 h-5 text-yellow-500"></i>
                                    <span id="footer-email">illuminatiblackrituals@gmail.com</span>
                                </div>
                                <div class="flex items-center gap-3">
                                    <i data-lucide="phone" class="w-5 h-5 text-yellow-500"></i>
                                    <span id="footer-phone">+27 XX XXX XXXX</span>
                                </div>
                                <div class="flex items-center gap-3">
                                    <i data-lucide="map-pin" class="w-5 h-5 text-yellow-500"></i>
                                    <span>Gauteng, Randburg, George AVE Street</span>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h4 class="text-lg font-bold mb-4">Quick Links</h4>
                            <div class="space-y-2 text-gray-400 text-sm">
                                <div class="hover:text-yellow-500 cursor-pointer transition">About Us</div>
                                <div class="hover:text-yellow-500 cursor-pointer transition">Shipping Info</div>
                                <div class="hover:text-yellow-500 cursor-pointer transition">Privacy Policy</div>
                                <div class="hover:text-yellow-500 cursor-pointer transition">Terms & Conditions</div>
                            </div>
                        </div>
                    </div>
                    <div class="border-t border-gray-800 pt-8 text-center">
                        <p id="footer-copyright" class="text-gray-500 text-sm">© 2024 Illuminati Black Rituals - Premium Spiritual Products</p>
                    </div>
                </div>
            </footer>
        </div>

        <!-- Product Detail Modal -->
        <div id="product-modal" class="modal hidden" onclick="if(event.target === this) closeProductModal()">
            <div class="modal-content" onclick="event.stopPropagation()">
                <div id="product-modal-content"></div>
            </div>
        </div>

        <!-- Checkout Page -->
        <div id="checkout-page" class="hidden min-h-screen py-12 px-6 bg-gray-50">
            <div class="max-w-4xl mx-auto">
                <div class="text-center mb-12">
                    <h1 class="text-5xl font-black text-gray-900 mb-4">Secure Checkout</h1>
                    <p class="text-gray-600 text-lg">Complete your spiritual purchase</p>
                </div>
                
                <div class="stat-card p-10 mb-8">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">Product Details</h2>
                    <div id="checkout-product-info" class="mb-8"></div>
                    
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">Your Information</h2>
                    <form id="checkout-form" class="space-y-6">
                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-bold mb-3 text-gray-700 uppercase tracking-wide">Full Name *</label>
                                <input id="checkout-name" required placeholder="Your full name" class="input-field">
                            </div>
                            <div>
                                <label class="block text-sm font-bold mb-3 text-gray-700 uppercase tracking-wide">Email *</label>
                                <input id="checkout-email" type="email" required placeholder="your@email.com" class="input-field">
                            </div>
                        </div>
                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-bold mb-3 text-gray-700 uppercase tracking-wide">Phone Number *</label>
                                <input id="checkout-phone" required placeholder="+27 XX XXX XXXX" class="input-field">
                            </div>
                            <div>
                                <label class="block text-sm font-bold mb-3 text-gray-700 uppercase tracking-wide">City *</label>
                                <input id="checkout-city" required placeholder="City name" class="input-field">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-bold mb-3 text-gray-700 uppercase tracking-wide">Delivery Address *</label>
                            <textarea id="checkout-address" required placeholder="Full delivery address..." class="input-field" rows="3"></textarea>
                        </div>
                        
                        <div class="flex gap-6 pt-6">
                            <button type="button" onclick="showPage('home')" class="flex-1 btn-secondary py-4 text-lg">
                                <i data-lucide="arrow-left" class="w-5 h-5 inline mr-2"></i>Back to Shop
                            </button>
                            <button type="submit" class="flex-1 btn-primary py-4 text-lg">
                                <i data-lucide="lock" class="w-5 h-5 inline mr-2"></i>Pay Now via PayFast
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Admin Login Modal -->
        <div id="admin-login-modal" class="modal hidden" onclick="if(event.target === this) closeAdminLogin()">
            <div class="bg-white rounded-2xl p-10 max-w-md w-full mx-4 shadow-2xl" onclick="event.stopPropagation()">
                <h2 class="text-3xl font-black text-gray-900 mb-6">Admin Access</h2>
                <input id="admin-password" type="password" placeholder="Enter admin password" class="input-field mb-6">
                <div class="flex gap-4">
                    <button onclick="closeAdminLogin()" class="flex-1 btn-secondary py-4">Cancel</button>
                    <button onclick="checkAdminPassword()" class="flex-1 btn-primary py-4">Login</button>
                </div>
            </div>
        </div>

        <!-- Success Modal -->
        <div id="success-modal" class="modal hidden">
            <div class="bg-white rounded-2xl p-12 max-w-lg w-full mx-4 text-center shadow-2xl">
                <div class="w-24 h-24 rounded-full mx-auto mb-6 flex items-center justify-center bg-gradient-to-br from-yellow-500 to-yellow-600">
                    <i data-lucide="check-circle" class="w-14 h-14 text-white"></i>
                </div>
                <h2 class="text-4xl font-black text-gray-900 mb-4">Payment Successful!</h2>
                <p class="text-gray-600 mb-8 text-lg">
                    Your order will be processed within 24 hours. 
                    Check your email for confirmation and tracking details.
                </p>
                <button onclick="closeSuccessModal()" class="btn-primary w-full py-4 text-lg">
                    Continue Shopping
                </button>
            </div>
        </div>
    </div>

    <script>
        // ===== FIREBASE CONFIGURATION =====
        const firebaseConfig = {
            apiKey: "AIzaSyDDMsvRTz9nPGDk8Ob_FPRc5Boov2FVt9w",
            authDomain: "egn-portal.firebaseapp.com",
            projectId: "egn-portal",
            storageBucket: "egn-portal.firebasestorage.app",
            messagingSenderId: "88252271549",
            appId: "1:88252271549:web:80aa211a420e205c1720d4",
            measurementId: "G-KYMBME9RDQ"
        };
        
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const storage = firebase.storage();
        
        // ===== PAYFAST CONFIGURATION =====
        const PAYFAST_MERCHANT_ID = '32909125';
        const PAYFAST_MERCHANT_KEY = 'zap68mi7ptd9l';
        const PAYFAST_URL = 'https://www.payfast.co.za/eng/process';
        const PAYFAST_RETURN_URL = 'https://zapk1.github.io/blackrituals/?payment=success';
        const PAYFAST_CANCEL_URL = 'https://zapk1.github.io/blackrituals/?payment=cancelled';
        
        // ===== DEFAULT PRODUCTS =====
        const DEFAULT_PRODUCTS = [
            {
                id: 'default-1',
                name: 'Illuminati PROTECTION  Ritual Ring',
                price: 6500,
                category: 'Protection Items',
                description: 'This is protection ring that can save you from Accidents , Gunshots  Danger and any bad situation set against you as the owner of the Illuminati BR protection ring .',
                details: 'Once you wear the ring after  being fully built spirituall built by instuction you get introduced to the world of fully protection against weapons , fights , enemies , and accidents , think like  anything aiming to  harm you it will never succceed that is purpose of the Ring from ILLUMINATI BR .',
                instructions: 'For usage or instructions pay required amount for the ritual , we will  call you and tell  about  the ring delivery and how to built it  spiritually . We only give instructions after  payments call  27810792898 for  more information .',
                images: [
                    'https://i.postimg.cc/rpxrWCfB/images-(14).jpg'],
                phone: '27810792898',
                isDefault: true
            },
            {
                id: 'default-2',
                name: 'Fame & Confidence ILLUMINATI BR Ritual Necklace',
                price: 5600,
                category: 'Ritual Kits',
                description: 'This is an ILLUMINATI BR Necklace built with Powerful black rituals mixed with human voice desires and invitation from ILLUMINATI WICCAN gods to grant fame and confidence to any perso who wears the necklace increasing you chances to get richh or better with desires of life because the Ritual listen to whhat you desire the most and  deliver .',
                details: 'This necklace is built with Black Rituals that makes people to instantly like your work or anything you do is like people will see your work and love and you will  be  favoured whereever you go , it does matter if youre an artist , businessman , creator  , self employed the Ritual Ring Works for anybody .',
                instructions: 'For usage or instructions pay required amount for the ritual , we will  call you and tell  about  the ring delivery and how to built it  spiritually . We only give instructions after  payments call  27810792898 for  more information .',
                images: [
                    'https://i.postimg.cc/d1XjvmVr/s-l1200-(1).jpg'
                ],
                phone: '27810792898',
                isDefault: true
            },
            {
                id: 'default-3',
                name: 'Personal WEALTH SUCCESS Ritual',
                price: 15000,
                category: 'rituals',
                description: 'This  is  the Ritual that can chsange your life and your situation mostly good for attracting wealth , commonly used around South Africa by most succesful people , this ritual includes double lack candles money ritual that will be performed to request  the wealth and money attraction boost from the cult members as the ritual . ',
                details: 'This ritual does not take any thing related to human sacrifices or the family related issues it only requires your voice , and dounle black  candles that will be delivered to you during the ritual performance this is more importantly for poor people to  get better  chance to be better .',
                instructions: 'For usage or instructions pay required amount for the ritual , we will  call you and tell  about  the ring delivery and how to built it  spiritually . We only give instructions after  payments call  27810792898 for  more information',
                images: [
                    'https://i.postimg.cc/BQzJxjw4/images-(20).jpg'
                ],
                 phone: '27810792898',
                isDefault: true
            },
            {
                id: 'default-4',
                name: 'Coin of Luck ILLUMINATI BR Ritual',
                price: 5500,
                category: 'Ritual Kits',
                description: 'This is a FULLY Ritual built Coin to attract the good energy and remove bad energy on any person who carries the ILLUMINATED Coin from Black Rituals whoever caries the coin lives pure luck on anything incuding business , job , gamling or anything that look  hard to  the world .',
                details: 'This coin turns you to be  a  everyones favourite it makes all  chances to be on your side with the pure LUCK BUILT by Black Rituals .',
                instructions: 'For usage or instructions pay required amount for the ritual , we will  call you and tell  about  the ring delivery and how to built it  spiritually . We only give instructions after  payments call  27810792898 for  more information .',
             images: [
                    'https://i.postimg.cc/fyVZSZZN/images-(4).jpg'
                ],
                phone: '27810792898',
                isDefault: true
            }
        ];

        // ===== DEFAULT TESTIMONIALS =====
        const DEFAULT_TESTIMONIALS = [
            {
                id: 'test-1',
                name: 'Nomsa Dlamini',
                title: 'Energy Healer',
                quote: 'The black sage bundle from Illuminati Black Rituals completely transformed my practice. The energy is authentic and powerful. I have been purchasing from them for over a year and the quality never disappoints.',
                image_url: 'https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=400&q=80',
                isDefault: true
            },
            {
                id: 'test-2',
                name: 'Thabo Maleka',
                title: 'Traditional Healer',
                quote: 'As a sangoma, I need genuine spiritual tools. Illuminati Black Rituals provides authentic products that carry real power. The obsidian stone helped me create the strongest protection ward I have ever cast.',
                image_url: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=400&q=80',
                isDefault: true
            },
            {
                id: 'test-3',
                name: 'Sarah van Rensburg',
                title: 'Spiritual Coach',
                quote: 'The full moon ritual kit is absolutely incredible! I have performed the ceremony three times and manifested everything I asked for. The instructions are clear and the materials are high quality.',
                image_url: 'https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=400&q=80',
                isDefault: true
            },
            {
                id: 'test-4',
                name: 'Marcus Johnson',
                title: 'Yoga Instructor',
                quote: 'I use the dragon blood oil before every class to protect the space. Students always comment on how safe and peaceful the energy feels. This oil is the real deal.',
                image_url: 'https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=400&q=80',
                isDefault: true
            },
            {
                id: 'test-5',
                name: 'Zanele Khumalo',
                title: 'Meditation Teacher',
                quote: 'The ancestral communication candle helped me finally connect with my grandmother who passed. I felt her presence so strongly. Thank you Illuminati Black Rituals for creating such powerful tools.',
                image_url: 'https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=400&q=80',
                isDefault: true
            }
        ];
        
        // ===== APPLICATION STATE =====
        let AppState = {
            currentPage: 'home',
            selectedProduct: null,
            customerData: null,
            products: [],
            testimonials: [],
            orders: [],
            settings: {
                shop_email: "illuminatiblackrituals@gmail.com",
                shop_phone: "+27 XX XXX XXXX",
                bank_details: "TymeBank Everyday Account: 5110 3334 333",
                footer_text: "© 2024 Illuminati Black Rituals - Premium Spiritual Products"
            },
            stats: {
                products: 0,
                customers: 0,
                orders: 0,
                revenue: 0
            }
        };
        
        // ===== INIT CHARTS =====
        let salesChart, categoryChart;
        
        function initCharts() {
            const salesCtx = document.getElementById('salesChart');
            const categoryCtx = document.getElementById('categoryChart');
            
            if (salesChart) salesChart.destroy();
            if (categoryChart) categoryChart.destroy();
            
            if (salesCtx) {
                const monthlyData = calculateMonthlyOrders();
                salesChart = new Chart(salesCtx, {
                    type: 'line',
                    data: {
                        labels: monthlyData.labels,
                        datasets: [{
                            label: 'Orders',
                            data: monthlyData.data,
                            borderColor: '#d4af37',
                            backgroundColor: 'rgba(212, 175, 55, 0.1)',
                            tension: 0.4,
                            fill: true,
                            borderWidth: 3
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { labels: { color: '#000', font: { weight: 'bold' } } }
                        },
                        scales: {
                            y: { ticks: { color: '#666' }, grid: { color: '#e5e7eb' } },
                            x: { ticks: { color: '#666' }, grid: { color: '#e5e7eb' } }
                        }
                    }
                });
            }
            
            if (categoryCtx) {
                const categoryData = calculateCategoryData();
                categoryChart = new Chart(categoryCtx, {
                    type: 'doughnut',
                    data: {
                        labels: categoryData.labels,
                        datasets: [{
                            data: categoryData.data,
                            backgroundColor: ['#d4af37', '#aa8b2e', '#8b7424', '#ffd700', '#b8860b', '#daa520']
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { labels: { color: '#000', font: { weight: 'bold' } } }
                        }
                    }
                });
            }
        }
        
        function calculateMonthlyOrders() {
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'];
            const data = [0, 0, 0, 0, 0, 0];
            
            AppState.orders.forEach(order => {
                if (order.timestamp) {
                    const date = order.timestamp.toDate ? order.timestamp.toDate() : new Date(order.timestamp);
                    const month = date.getMonth();
                    if (month < 6) data[month]++;
                }
            });
            
            return { labels: months, data: data };
        }
        
        function calculateCategoryData() {
            const categories = {};
            AppState.products.forEach(p => {
                categories[p.category] = (categories[p.category] || 0) + 1;
            });
            return {
                labels: Object.keys(categories),
                data: Object.values(categories)
            };
        }
        
        // ===== FIREBASE STORAGE UPLOAD =====
        async function uploadImagesToStorage(files) {
            const uploadPromises = Array.from(files).map(async (file) => {
                const timestamp = Date.now();
                const filename = `products/${timestamp}_${file.name}`;
                const storageRef = storage.ref(filename);
                
                await storageRef.put(file);
                const url = await storageRef.getDownloadURL();
                return url;
            });
            
            return await Promise.all(uploadPromises);
        }
        
        async function uploadSingleImage(file) {
            const timestamp = Date.now();
            const filename = `testimonials/${timestamp}_${file.name}`;
            const storageRef = storage.ref(filename);
            
            await storageRef.put(file);
            return await storageRef.getDownloadURL();
        }
        
        // ===== FIREBASE FUNCTIONS =====
        async function loadProductsFromFirebase() {
            try {
                const snapshot = await db.collection('products').orderBy('created_at', 'desc').get();
                const firebaseProducts = snapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data(),
                    isDefault: false
                }));
                
                AppState.products = [...DEFAULT_PRODUCTS, ...firebaseProducts];
                AppState.stats.products = AppState.products.length;
                updateStats();
                displayProducts();
                displayAdminProducts();
            } catch (error) {
                console.error('Error loading products:', error);
                AppState.products = DEFAULT_PRODUCTS;
                AppState.stats.products = DEFAULT_PRODUCTS.length;
                displayProducts();
            }
        }

        async function loadTestimonialsFromFirebase() {
            try {
                const snapshot = await db.collection('testimonials').orderBy('created_at', 'desc').get();
                const firebaseTestimonials = snapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data(),
                    isDefault: false
                }));
                
                AppState.testimonials = [...DEFAULT_TESTIMONIALS, ...firebaseTestimonials];
                displayTestimonials();
                displayAdminTestimonials();
            } catch (error) {
                console.error('Error loading testimonials:', error);
                AppState.testimonials = DEFAULT_TESTIMONIALS;
                displayTestimonials();
            }
        }
        
        async function loadOrdersFromFirebase() {
            try {
                const snapshot = await db.collection('orders').orderBy('timestamp', 'desc').get();
                AppState.orders = snapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));
                
                // Calculate real stats
                const uniqueCustomers = new Set(AppState.orders.map(o => o.email_address)).size;
                const totalRevenue = AppState.orders
                    .filter(o => o.status === 'completed' || o.status === 'paid')
                    .reduce((sum, o) => sum + parseFloat(o.amount || 0), 0);
                
                AppState.stats.customers = uniqueCustomers;
                AppState.stats.orders = AppState.orders.length;
                AppState.stats.revenue = totalRevenue;
                
                updateStats();
                displayOrders();
                
                if (salesChart || categoryChart) {
                    initCharts();
                }
            } catch (error) {
                console.error('Error loading orders:', error);
            }
        }

        async function addProduct() {
            const name = document.getElementById('new-product-name').value.trim();
            const price = parseFloat(document.getElementById('new-product-price').value);
            const category = document.getElementById('new-product-category').value;
            const description = document.getElementById('new-product-description').value.trim();
            const details = document.getElementById('new-product-details').value.trim();
            const instructions = document.getElementById('new-product-instructions').value.trim();
            const imageFiles = document.getElementById('new-product-images').files;
            const phone = document.getElementById('new-product-phone').value.trim();
            
            if (!name || !price || !description || !details || !instructions || !phone) {
                showToast('Please fill all required fields', 'error');
                return;
            }
            
            if (imageFiles.length === 0) {
                showToast('Please upload at least one image', 'error');
                return;
            }
            
            const btn = document.getElementById('add-product-btn');
            btn.disabled = true;
            btn.innerHTML = '<i data-lucide="loader" class="w-5 h-5 inline mr-2 animate-spin"></i>Uploading Images...';
            lucide.createIcons();
            
            try {
                const imageUrls = await uploadImagesToStorage(imageFiles);
                
                const productData = {
                    name, price, category, description, details, instructions, phone,
                    images: imageUrls,
                    created_at: firebase.firestore.FieldValue.serverTimestamp()
                };
                
                await db.collection('products').add(productData);
                
                document.getElementById('new-product-name').value = '';
                document.getElementById('new-product-price').value = '';
                document.getElementById('new-product-description').value = '';
                document.getElementById('new-product-details').value = '';
                document.getElementById('new-product-instructions').value = '';
                document.getElementById('new-product-images').value = '';
                document.getElementById('new-product-phone').value = '';
                document.getElementById('image-preview').innerHTML = '';
                
                showToast('✅ Product added successfully!');
                await loadProductsFromFirebase();
            } catch (error) {
                console.error('Error adding product:', error);
                showToast('❌ Failed to add product', 'error');
            }
            
            btn.disabled = false;
            btn.innerHTML = '<i data-lucide="plus" class="w-6 h-6 inline mr-2"></i>Add Product to Store';
            lucide.createIcons();
        }
        
        document.getElementById('new-product-images').addEventListener('change', function(e) {
            const preview = document.getElementById('image-preview');
            preview.innerHTML = '';
            
            Array.from(e.target.files).forEach(file => {
                const reader = new FileReader();
                reader.onload = function(event) {
                    const img = document.createElement('img');
                    img.src = event.target.result;
                    img.className = 'w-20 h-20 object-cover rounded-lg border-2 border-gray-300';
                    preview.appendChild(img);
                };
                reader.readAsDataURL(file);
            });
        });

        async function deleteProduct(id, isDefault) {
            if (isDefault) {
                showToast('❌ Cannot delete default products', 'error');
                return;
            }
            
            if (!confirm('Delete this product permanently?')) return;
            
            try {
                await db.collection('products').doc(id).delete();
                showToast('✅ Product deleted!');
                await loadProductsFromFirebase();
            } catch (error) {
                console.error('Error deleting product:', error);
                showToast('❌ Failed to delete', 'error');
            }
        }

        async function addTestimonial() {
            const name = document.getElementById('new-testimonial-name').value.trim();
            const title = document.getElementById('new-testimonial-title').value.trim();
            const quote = document.getElementById('new-testimonial-quote').value.trim();
            const imageFile = document.getElementById('new-testimonial-image').files[0];
            
            if (!name || !title || !quote) {
                showToast('Please fill all fields', 'error');
                return;
            }
            
            try {
                let imageUrl = 'https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=400&q=80';
                
                if (imageFile) {
                    imageUrl = await uploadSingleImage(imageFile);
                }
                
                const testimonialData = {
                    name, title, quote, image_url: imageUrl,
                    created_at: firebase.firestore.FieldValue.serverTimestamp()
                };
                
                await db.collection('testimonials').add(testimonialData);
                
                document.getElementById('new-testimonial-name').value = '';
                document.getElementById('new-testimonial-title').value = '';
                document.getElementById('new-testimonial-quote').value = '';
                document.getElementById('new-testimonial-image').value = '';
                
                showToast('✅ Testimonial added!');
                await loadTestimonialsFromFirebase();
            } catch (error) {
                console.error('Error adding testimonial:', error);
                showToast('❌ Failed to add', 'error');
            }
        }

        async function deleteTestimonial(id, isDefault) {
            if (isDefault) {
                showToast('❌ Cannot delete default testimonials', 'error');
                return;
            }
            
            if (!confirm('Delete this testimonial?')) return;
            
            try {
                await db.collection('testimonials').doc(id).delete();
                showToast('✅ Testimonial deleted!');
                await loadTestimonialsFromFirebase();
            } catch (error) {
                console.error('Error deleting:', error);
                showToast('❌ Failed to delete', 'error');
            }
        }
        
        async function markOrderCompleted(orderId) {
            try {
                await db.collection('orders').doc(orderId).update({
                    status: 'completed',
                    completed_at: firebase.firestore.FieldValue.serverTimestamp()
                });
                showToast('✅ Order marked as completed!');
                await loadOrdersFromFirebase();
            } catch (error) {
                console.error('Error updating order:', error);
                showToast('❌ Failed to update order', 'error');
            }
        }

        function displayProducts() {
            const grid = document.getElementById('products-grid');
            if (!grid) return;
            
            grid.innerHTML = AppState.products.map(product => {
                const mainImage = product.images ? product.images[0] : product.image_url;
                return `
                    <div class="product-card">
                        <div class="relative h-72 overflow-hidden" onclick='showProductDetails(${JSON.stringify(product).replace(/'/g, "&#39;")})'>
                            <img src="${mainImage}" alt="${product.name}" 
                                 class="w-full h-full object-cover transition-transform duration-500">
                            <span class="badge absolute top-4 left-4">${product.category}</span>
                        </div>
                        <div class="p-6">
                            <h3 class="text-xl font-bold text-gray-900 mb-2 leading-tight" onclick='showProductDetails(${JSON.stringify(product).replace(/'/g, "&#39;")})'>${product.name}</h3>
                            <p class="text-gray-600 text-sm mb-4 leading-relaxed line-clamp-2">${product.description}</p>
                            
                            <div class="alert-box">
                                <i data-lucide="info" class="w-5 h-5 flex-shrink-0"></i>
                                <p class="text-xs">Pay to get full instructions & ritual items. Call after payment.</p>
                            </div>
                            
                            <div class="flex items-center justify-between mt-4">
                                <span class="price-tag">R${product.price}</span>
                            </div>
                            
                            <button onclick='directBuy(${JSON.stringify(product).replace(/'/g, "&#39;")})' class="btn-primary w-full mt-4">
                                <i data-lucide="shopping-cart" class="w-4 h-4 inline mr-2"></i>Buy Now
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
            
            lucide.createIcons();
        }

        function showProductDetails(product) {
            AppState.selectedProduct = product;
            const modal = document.getElementById('product-modal');
            const content = document.getElementById('product-modal-content');
            
            const images = product.images || [product.image_url];
            
            content.innerHTML = `
                <div class="p-8">
                    <div class="grid md:grid-cols-2 gap-8">
                        <div>
                            <img src="${images[0]}" id="main-product-image" alt="${product.name}" 
                                 class="w-full h-96 object-cover rounded-2xl mb-4">
                            ${images.length > 1 ? `
                                <div class="image-gallery">
                                    ${images.map((img, idx) => `
                                        <img src="${img}" onclick="document.getElementById('main-product-image').src='${img}'" 
                                             alt="View ${idx + 1}" class="w-20 h-20 object-cover rounded-lg border-2 border-gray-300 hover:border-yellow-500 cursor-pointer transition">
                                    `).join('')}
                                </div>
                            ` : ''}
                            
                            <div class="flex gap-4 mt-6">
                                <button onclick="directBuy(${JSON.stringify(product).replace(/'/g, "&#39;")})" class="btn-primary flex-1 py-4">
                                    <i data-lucide="shopping-cart" class="w-5 h-5 inline mr-2"></i>Buy Now - R${product.price}
                                </button>
                                <button onclick="closeProductModal()" class="btn-secondary px-8">
                                    <i data-lucide="x" class="w-5 h-5"></i>
                                </button>
                            </div>
                        </div>
                        <div class="overflow-y-auto max-h-[600px] pr-4">
                            <span class="badge mb-4">${product.category}</span>
                            <h2 class="text-4xl font-black text-gray-900 mb-4">${product.name}</h2>
                            <div class="price-tag mb-6">R${product.price}</div>
                            
                            ${product.phone ? `
                            <div class="mb-6 p-4 rounded-xl bg-yellow-50 border-2 border-yellow-500">
                                <div class="flex items-center gap-3 text-gray-900">
                                    <i data-lucide="phone" class="w-5 h-5 text-yellow-600"></i>
                                    <span class="font-bold">Contact: ${product.phone}</span>
                                </div>
                            </div>
                            ` : ''}
                            
                            <div class="alert-box mb-6">
                                <i data-lucide="lock" class="w-6 h-6"></i>
                                <div>
                                    <p class="font-bold mb-1">Full Instructions After Payment</p>
                                    <p class="text-xs">Complete your purchase to receive detailed ritual instructions and product support via call.</p>
                                </div>
                            </div>
                            
                            <div class="space-y-6">
                                <div>
                                    <h3 class="text-xl font-bold text-gray-900 mb-3 flex items-center gap-2">
                                        <i data-lucide="info" class="w-5 h-5 text-yellow-600"></i>
                                        Product Description
                                    </h3>
                                    <p class="text-gray-700 leading-relaxed">${product.details || product.description}</p>
                                </div>
                                
                                <div>
                                    <h3 class="text-xl font-bold text-gray-900 mb-3 flex items-center gap-2">
                                        <i data-lucide="book-open" class="w-5 h-5 text-yellow-600"></i>
                                        Basic Usage Guide
                                    </h3>
                                    <p class="text-gray-700 leading-relaxed">${product.instructions}</p>
                                    <div class="mt-4 p-4 bg-yellow-50 rounded-lg border border-yellow-200">
                                        <p class="text-sm text-gray-700">
                                            <i data-lucide="alert-circle" class="w-4 h-4 inline mr-1 text-yellow-600"></i>
                                            <strong>Note:</strong> Full step-by-step ritual instructions and personalized guidance will be provided after purchase via phone consultation.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            modal.classList.remove('hidden');
            lucide.createIcons();
        }

        function closeProductModal() {
            document.getElementById('product-modal').classList.add('hidden');
        }

        function displayAdminProducts() {
            const list = document.getElementById('admin-products-list');
            if (!list) return;
            
            list.innerHTML = AppState.products.length === 0 
                ? '<p class="text-gray-500 col-span-full text-center py-12 text-lg">No products yet.</p>'
                : AppState.products.map(p => {
                    const mainImage = p.images ? p.images[0] : p.image_url;
                    return `
                        <div class="stat-card p-6">
                            <img src="${mainImage}" class="w-full h-48 object-cover rounded-xl mb-4">
                            ${p.images && p.images.length > 1 ? `<p class="text-xs text-gray-500 mb-2">${p.images.length} images</p>` : ''}
                            <h4 class="font-bold text-gray-900 text-lg mb-2">${p.name}</h4>
                            <p class="text-yellow-600 font-bold text-xl mb-2">R${p.price}</p>
                            <span class="badge text-xs">${p.category}</span>
                            ${!p.isDefault ? `
                                <button onclick="deleteProduct('${p.id}', false)" class="w-full mt-4 py-3 bg-red-600 hover:bg-red-700 text-white rounded-xl font-bold transition">
                                    <i data-lucide="trash-2" class="w-4 h-4 inline mr-2"></i>Delete
                                </button>
                            ` : '<p class="text-xs text-gray-500 mt-4 text-center">Default Product</p>'}
                        </div>
                    `;
                }).join('');
            
            lucide.createIcons();
        }
        
        function displayOrders() {
            const list = document.getElementById('orders-list');
            if (!list) return;
            
            if (AppState.orders.length === 0) {
                list.innerHTML = '<p class="text-gray-500 text-center py-12 text-lg">No orders yet.</p>';
                return;
            }
            
            list.innerHTML = AppState.orders.map(order => {
                const isCompleted = order.status === 'completed';
                const date = order.timestamp ? (order.timestamp.toDate ? order.timestamp.toDate() : new Date(order.timestamp)) : new Date();
                
                return `
                    <div class="order-card ${isCompleted ? 'completed' : ''}">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h4 class="text-lg font-bold text-gray-900 mb-1">${order.item_name || 'Product'}</h4>
                                <p class="text-sm text-gray-600">Order ID: ${order.m_payment_id || order.id}</p>
                                <p class="text-xs text-gray-500">${date.toLocaleString()}</p>
                            </div>
                            <div class="text-right">
                                <div class="text-2xl font-bold text-yellow-600">R${parseFloat(order.amount || 0).toFixed(2)}</div>
                                <span class="inline-block px-3 py-1 rounded-full text-xs font-bold ${
                                    isCompleted ? 'bg-green-100 text-green-800' : 
                                    order.status === 'paid' ? 'bg-blue-100 text-blue-800' : 
                                    'bg-yellow-100 text-yellow-800'
                                }">
                                    ${isCompleted ? 'COMPLETED' : order.status === 'paid' ? 'PAID' : 'PENDING'}
                                </span>
                            </div>
                        </div>
                        
                        <div class="grid md:grid-cols-2 gap-4 mb-4 text-sm">
                            <div>
                                <p class="text-gray-600 mb-1"><strong>Customer:</strong> ${order.name_first} ${order.name_last}</p>
                                <p class="text-gray-600 mb-1"><strong>Email:</strong> ${order.email_address}</p>
                                <p class="text-gray-600"><strong>Phone:</strong> ${order.cell_number}</p>
                            </div>
                            <div>
                                <p class="text-gray-600 mb-1"><strong>Product ID:</strong> ${order.custom_str1 || 'N/A'}</p>
                                <p class="text-gray-600"><strong>Address:</strong> ${order.custom_str2 || 'N/A'}</p>
                            </div>
                        </div>
                        
                        ${!isCompleted ? `
                            <button onclick="markOrderCompleted('${order.id}')" class="btn-primary w-full py-3">
                                <i data-lucide="check-square" class="w-4 h-4 inline mr-2"></i>Mark as Completed
                            </button>
                        ` : `
                            <div class="bg-green-50 border-2 border-green-500 rounded-xl p-4 text-center">
                                <i data-lucide="check-circle" class="w-6 h-6 inline mr-2 text-green-600"></i>
                                <span class="font-bold text-green-800">Order Fulfilled</span>
                            </div>
                        `}
                    </div>
                `;
            }).join('');
            
            lucide.createIcons();
        }

        function displayTestimonials() {
            const grid = document.getElementById('testimonials-grid');
            if (!grid) return;
            
            grid.innerHTML = AppState.testimonials.map(t => `
                <div class="stat-card p-8">
                    <div class="flex items-center gap-4 mb-6">
                        <img src="${t.image_url}" alt="${t.name}" 
                             class="w-16 h-16 rounded-full object-cover border-2 border-yellow-500">
                        <div>
                            <div class="font-bold text-gray-900 text-lg">${t.name}</div>
                            <div class="text-yellow-600 text-sm font-semibold">${t.title}</div>
                        </div>
                    </div>
                    <p class="text-gray-700 italic leading-relaxed">"${t.quote}"</p>
                </div>
            `).join('');
        }

        function displayAdminTestimonials() {
            const list = document.getElementById('testimonials-admin-list');
            if (!list) return;
            
            const firebaseOnly = AppState.testimonials.filter(t => !t.isDefault);
            list.innerHTML = firebaseOnly.length === 0 
                ? '<p class="text-gray-500 text-center py-8">No custom testimonials yet.</p>'
                : firebaseOnly.map(t => `
                    <div class="stat-card p-4 flex items-center justify-between">
                        <div class="flex items-center gap-3">
                            <img src="${t.image_url}" class="w-12 h-12 rounded-full object-cover">
                            <div>
                                <div class="font-bold text-gray-900">${t.name}</div>
                                <div class="text-gray-600 text-sm">${t.title}</div>
                            </div>
                        </div>
                        <button onclick="deleteTestimonial('${t.id}', false)" class="btn-secondary px-4 py-2">
                            <i data-lucide="trash-2" class="w-4 h-4"></i>
                        </button>
                    </div>
                `).join('');
            
            lucide.createIcons();
        }

        function directBuy(product) {
            AppState.selectedProduct = product;
            closeProductModal();
            
            const info = document.getElementById('checkout-product-info');
            const mainImage = product.images ? product.images[0] : product.image_url;
            info.innerHTML = `
                <div class="flex gap-6 p-6 rounded-2xl bg-yellow-50 border-2 border-yellow-500">
                    <img src="${mainImage}" class="w-32 h-32 object-cover rounded-xl">
                    <div class="flex-1">
                        <h3 class="font-bold text-gray-900 text-2xl mb-2">${product.name}</h3>
                        <p class="text-gray-600 mb-3">${product.description}</p>
                        <div class="price-tag">R${product.price}</div>
                    </div>
                </div>
            `;
            
            showPage('checkout');
        }

        function updateStats() {
            document.getElementById('stat-products').textContent = AppState.stats.products;
            document.getElementById('stat-customers').textContent = AppState.stats.customers;
            document.getElementById('stat-orders').textContent = AppState.stats.orders;
            document.getElementById('stat-revenue').textContent = 'R ' + AppState.stats.revenue.toLocaleString();
        }

        // ===== PAYFAST PAYMENT =====
        async function initiatePayFast(product, customerData) {
            const amount = product.price;
            const merchantPaymentId = 'BR-' + Date.now();
            
            const nameParts = customerData.name.trim().split(' ');
            const firstName = nameParts[0];
            const lastName = nameParts.slice(1).join(' ') || firstName;
            const cleanPhone = customerData.phone.replace(/[\s\-\(\)]/g, '');
            
            const paymentData = {
                'merchant_id': PAYFAST_MERCHANT_ID,
                'merchant_key': PAYFAST_MERCHANT_KEY,
                'return_url': PAYFAST_RETURN_URL,
                'cancel_url': PAYFAST_CANCEL_URL,
                'notify_url': 'https://zapk1.github.io/egnportal/payfast-notify',
                'name_first': firstName,
                'name_last': lastName,
                'email_address': customerData.email,
                'cell_number': cleanPhone,
                'm_payment_id': merchantPaymentId,
                'amount': amount.toFixed(2),
                'item_name': product.name,
                'item_description': product.description,
                'custom_str1': product.id,
                'custom_str2': customerData.address,
                'custom_str3': customerData.city
            };
            
            try {
                await db.collection('orders').add({
                    ...paymentData,
                    product_name: product.name,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    status: 'pending'
                });
            } catch (err) {
                console.error('Failed to log order:', err);
            }
            
            const form = document.createElement('form');
            form.method = 'POST';
            form.action = PAYFAST_URL;
            
            for (let key in paymentData) {
                const input = document.createElement('input');
                input.type = 'hidden';
                input.name = key;
                input.value = paymentData[key];
                form.appendChild(input);
            }
            
            document.body.appendChild(form);
            showToast('🔄 Redirecting to PayFast secure payment...', 'success');
            
            setTimeout(() => form.submit(), 1500);
        }

        document.getElementById('checkout-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            AppState.customerData = {
                name: document.getElementById('checkout-name').value.trim(),
                email: document.getElementById('checkout-email').value.trim(),
                phone: document.getElementById('checkout-phone').value.trim(),
                city: document.getElementById('checkout-city').value.trim(),
                address: document.getElementById('checkout-address').value.trim()
            };
            
            if (confirm(`💳 Proceed to secure payment of R${AppState.selectedProduct.price} for ${AppState.selectedProduct.name}?\n\nYou will be redirected to PayFast.`)) {
                initiatePayFast(AppState.selectedProduct, AppState.customerData);
            }
        });

        // ===== UTILITY FUNCTIONS =====
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = 'toast' + (type === 'error' ? ' error' : '');
            toast.textContent = message;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 4000);
        }

        function showPage(pageId) {
            document.querySelectorAll('#app-container > div').forEach(p => p.classList.add('hidden'));
            document.getElementById(pageId + '-page').classList.remove('hidden');
            AppState.currentPage = pageId;
            
            if (pageId === 'admin') {
                setTimeout(() => initCharts(), 100);
            }
            
            lucide.createIcons();
        }

        function showAdminLogin() {
            document.getElementById('admin-login-modal').classList.remove('hidden');
            lucide.createIcons();
        }

        function closeAdminLogin() {
            document.getElementById('admin-login-modal').classList.add('hidden');
            document.getElementById('admin-password').value = '';
        }

        async function checkAdminPassword() {
            const password = document.getElementById('admin-password').value;
            if (password === 'VNAXXTTM') {
                closeAdminLogin();
                showPage('admin');
                showAdminTab('products');
                await loadProductsFromFirebase();
                await loadTestimonialsFromFirebase();
                await loadOrdersFromFirebase();
                initCharts();
            } else {
                showToast('❌ Invalid password', 'error');
            }
        }

        function showAdminTab(tabId) {
            document.querySelectorAll('.admin-content').forEach(c => c.classList.add('hidden'));
            document.querySelectorAll('.tab-button').forEach(t => t.classList.remove('active'));
            document.getElementById('admin-content-' + tabId).classList.remove('hidden');
            document.getElementById('admin-tab-' + tabId).classList.add('active');
            lucide.createIcons();
        }

        function saveSettings() {
            AppState.settings.shop_email = document.getElementById('shop-email').value;
            AppState.settings.shop_phone = document.getElementById('shop-phone').value;
            AppState.settings.bank_details = document.getElementById('bank-details').value;
            AppState.settings.footer_text = document.getElementById('footer-text').value;
            
            document.getElementById('footer-copyright').textContent = AppState.settings.footer_text;
            document.getElementById('footer-email').textContent = AppState.settings.shop_email;
            document.getElementById('footer-phone').textContent = AppState.settings.shop_phone;
            
            localStorage.setItem('shop_settings', JSON.stringify(AppState.settings));
            showToast('✅ Settings saved successfully!');
        }

        window.addEventListener('load', async function() {
            const urlParams = new URLSearchParams(window.location.search);
            const paymentStatus = urlParams.get('payment');
            
            if (paymentStatus === 'success') {
                document.getElementById('success-modal').classList.remove('hidden');
                window.history.replaceState({}, document.title, window.location.pathname);
            } else if (paymentStatus === 'cancelled') {
                showToast('❌ Payment cancelled', 'error');
                window.history.replaceState({}, document.title, window.location.pathname);
            }
            
            const savedSettings = localStorage.getItem('shop_settings');
            if (savedSettings) {
                AppState.settings = {...AppState.settings, ...JSON.parse(savedSettings)};
                document.getElementById('footer-copyright').textContent = AppState.settings.footer_text;
                document.getElementById('footer-email').textContent = AppState.settings.shop_email;
                document.getElementById('footer-phone').textContent = AppState.settings.shop_phone;
            }
            
            await loadProductsFromFirebase();
            await loadTestimonialsFromFirebase();
            await loadOrdersFromFirebase();
            lucide.createIcons();
        });

        function closeSuccessModal() {
            document.getElementById('success-modal').classList.add('hidden');
            showPage('home');
        }
        
        lucide.createIcons();
    </script>
</body>
</html>
