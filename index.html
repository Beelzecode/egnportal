<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#2196f3">
    <title>Join The Illuminati - Elite Global Network</title>
    <link rel="icon" href__="https://i.postimg.cc/NMkR11xZ/c7c0219f9-Illuminati-Eyewith-South-African-Flag.png" type="image/png">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <link rel="preconnect" href__="https://fonts.googleapis.com">
    <link rel="preconnect" href__="https://fonts.gstatic.com" crossorigin>
    <link href__="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <style>
        body { font-family: 'Inter', sans-serif; margin: 0; padding: 0; }
        .hidden { display: none !important; }
        .fade-in { animation: fadeIn 0.6s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        
        .membership-card { 
            background: white; 
            border-radius: 12px; 
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); 
            overflow: hidden; 
            transition: all 0.3s ease; 
        }
        .membership-card:hover { 
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); 
            transform: translateY(-4px); 
        }
        
        .btn-primary { 
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%); 
            color: white; 
            padding: 16px 24px; 
            border: none; 
            border-radius: 8px; 
            font-weight: 700; 
            cursor: pointer; 
            transition: all 0.3s ease; 
            text-transform: uppercase; 
            letter-spacing: 0.5px; 
        }
        .btn-primary:hover { 
            background: linear-gradient(135deg, #1d4ed8 0%, #1e40af 100%); 
            transform: translateY(-2px); 
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.4); 
        }
        
        .input-field { 
            width: 100%; 
            padding: 12px 16px; 
            background: #f9fafb; 
            border: 1px solid #d1d5db; 
            border-radius: 8px; 
            font-size: 16px; 
            transition: all 0.2s; 
        }
        .input-field:focus { 
            outline: none; 
            border-color: #3b82f6; 
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1); 
        }
        
        textarea.input-field { min-height: 80px; resize: vertical; }
        
        .tab-button { 
            padding: 12px 16px; 
            background: #f3f4f6; 
            border: none; 
            border-radius: 8px; 
            cursor: pointer; 
            transition: all 0.2s; 
            margin-right: 8px; 
        }
        .tab-button.active { 
            background: white; 
            box-shadow: 0 1px 3px rgba(0,0,0,0.1); 
        }
        
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #10b981;
            color: white;
            padding: 16px 24px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 9999;
            animation: slideIn 0.3s ease;
        }
        .toast.error { background: #ef4444; }
        
        @keyframes slideIn {
            from { transform: translateX(400px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .payment-tab { 
            padding: 12px 20px; 
            background: transparent; 
            border: none; 
            border-radius: 6px; 
            cursor: pointer; 
            transition: all 0.2s; 
        }
        .payment-tab.active { 
            background-color: white; 
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1); 
        }
    </style>
</head>

<body class="bg-white">
    <div id="app-container">
        <!-- Admin Panel -->
        <div id="admin-page" class="hidden min-h-screen bg-gray-100 p-4">
            <div class="max-w-7xl mx-auto">
                <div class="flex justify-between items-center mb-8">
                    <div>
                        <h1 class="text-4xl font-bold text-gray-900">Admin Dashboard</h1>
                        <p class="text-gray-600 mt-1">Welcome, King. Manage the network.</p>
                    </div>
                    <button onclick="showPage('home')" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Back to Site</button>
                </div>

                <!-- Admin Tabs -->
                <div class="mb-6">
                    <div class="flex flex-wrap gap-2">
                        <button onclick="showAdminTab('homepage')" id="admin-tab-homepage" class="tab-button active">
                            <i data-lucide="home" class="w-4 h-4 inline mr-2"></i>Homepage
                        </button>
                        <button onclick="showAdminTab('payments')" id="admin-tab-payments" class="tab-button">
                            <i data-lucide="credit-card" class="w-4 h-4 inline mr-2"></i>Payments
                        </button>
                        <button onclick="showAdminTab('general')" id="admin-tab-general" class="tab-button">
                            <i data-lucide="settings" class="w-4 h-4 inline mr-2"></i>General
                        </button>
                    </div>
                </div>

                <!-- Homepage Tab -->
                <div id="admin-content-homepage" class="admin-content">
                    <div class="grid gap-6 lg:grid-cols-2">
                        <div class="bg-white rounded-lg shadow p-6">
                            <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
                                <i data-lucide="image" class="w-5 h-5"></i>Membership Card Images
                            </h2>
                            
                            <div class="space-y-6">
                                <div class="p-4 border rounded-lg">
                                    <label class="font-semibold block mb-2">ADEPT Card Image</label>
                                    <div id="adept-image-preview" class="mb-3">
                                        <img src="https://i.postimg.cc/MT2HTNhc/Screenshot-2025-11-06-160855.png" class="w-full h-48 object-cover rounded">
                                    </div>
                                    <input id="adept-image-url" type="text" value="https://i.postimg.cc/MT2HTNhc/Screenshot-2025-11-06-160855.png" 
                                           onchange="updateImagePreview('adept', this.value)" class="input-field">
                                </div>
                                
                                <div class="p-4 border rounded-lg">
                                    <label class="font-semibold block mb-2">ILLUMINATIUM Card Image</label>
                                    <div id="illuminatium-image-preview" class="mb-3">
                                        <img src="https://i.postimg.cc/q7DpWYGJ/Screenshot-2025-11-06-164756.png" class="w-full h-48 object-cover rounded">
                                    </div>
                                    <input id="illuminatium-image-url" type="text" value="https://i.postimg.cc/q7DpWYGJ/Screenshot-2025-11-06-164756.png" 
                                           onchange="updateImagePreview('illuminatium', this.value)" class="input-field">
                                </div>
                                
                                <div class="p-4 border rounded-lg">
                                    <label class="font-semibold block mb-2">Influencer Card Image</label>
                                    <div id="influencer-image-preview" class="mb-3">
                                        <img src="https://i.postimg.cc/Btf11w2Y/istockphoto-2176715152-612x612.jpg" class="w-full h-48 object-cover rounded">
                                    </div>
                                    <input id="influencer-image-url" type="text" value="https://i.postimg.cc/Btf11w2Y/istockphoto-2176715152-612x612.jpg" 
                                           onchange="updateImagePreview('influencer', this.value)" class="input-field">
                                </div>
                                
                                <div class="p-4 border rounded-lg">
                                    <label class="font-semibold block mb-2">Full Worshiper Card Image</label>
                                    <div id="worshiper-image-preview" class="mb-3">
                                        <img src="https://i.postimg.cc/D091Pz3c/istockphoto-508068250-612x612.jpg" class="w-full h-48 object-cover rounded">
                                    </div>
                                    <input id="worshiper-image-url" type="text" value="https://i.postimg.cc/D091Pz3c/istockphoto-508068250-612x612.jpg" 
                                           onchange="updateImagePreview('worshiper', this.value)" class="input-field">
                                </div>
                            </div>
                        </div>

                        <div class="bg-white rounded-lg shadow p-6">
                            <h2 class="text-xl font-bold mb-4">Homepage Settings</h2>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium mb-2">Initiations Hosted</label>
                                    <input id="initiations-hosted" type="number" value="137" class="input-field">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">Global Members</label>
                                    <input id="next-members-count" type="number" value="2500" class="input-field">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">Attorney Section Title</label>
                                    <input id="attorney-section-title" value="Our Commitment to Secrecy" class="input-field">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">Attorney Section Text</label>
                                    <textarea id="attorney-section-text" class="input-field">Your ascension into the Illuminati is a sacred pact. Every application, every correspondence, and your very identity are shielded by layers of digital and legal protection, ensuring your journey with us remains in absolute confidence.</textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Testimonials Management -->
                        <div class="lg:col-span-2 bg-white rounded-lg shadow p-6">
                            <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
                                <i data-lucide="users" class="w-5 h-5"></i>Testimonials Management
                            </h2>
                            <div class="grid gap-6 md:grid-cols-2">
                                <div class="space-y-4 p-4 border rounded-lg">
                                    <h4 class="font-semibold">Add New Testimonial</h4>
                                    <input id="new-testimonial-name" placeholder="Name" class="input-field">
                                    <input id="new-testimonial-title" placeholder="Title (e.g., Entrepreneur)" class="input-field">
                                    <textarea id="new-testimonial-quote" placeholder="Quote..." class="input-field"></textarea>
                                    <input id="new-testimonial-image" placeholder="Image URL..." class="input-field">
                                    <button onclick="addTestimonial()" class="btn-primary w-full">
                                        <i data-lucide="plus-circle" class="w-4 h-4 inline mr-2"></i>Add Testimonial
                                    </button>
                                </div>
                                <div class="space-y-4">
                                    <h4 class="font-semibold">Current Testimonials (From Firestore)</h4>
                                    <div id="testimonials-list" class="max-h-96 overflow-y-auto space-y-3 pr-2"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Ceremony Gallery -->
                        <div class="lg:col-span-2 bg-white rounded-lg shadow p-6">
                            <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
                                <i data-lucide="camera" class="w-5 h-5"></i>Ceremony Gallery Management
                            </h2>
                            <div class="grid gap-6 md:grid-cols-2">
                                <div class="space-y-4 p-4 border rounded-lg">
                                    <h4 class="font-semibold">Add New Ceremony Photo</h4>
                                    <input id="new-ceremony-title" placeholder="Title" class="input-field">
                                    <textarea id="new-ceremony-description" placeholder="Brief description..." class="input-field"></textarea>
                                    <input id="new-ceremony-image" placeholder="Image URL..." class="input-field">
                                    <button onclick="addCeremony()" class="btn-primary w-full">
                                        <i data-lucide="plus-circle" class="w-4 h-4 inline mr-2"></i>Add Photo
                                    </button>
                                </div>
                                <div class="space-y-4">
                                    <h4 class="font-semibold">Current Photos (From Firestore)</h4>
                                    <div id="ceremonies-list" class="max-h-96 overflow-y-auto space-y-3 pr-2"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <button onclick="saveAllSettings()" class="w-full mt-6 btn-primary text-lg py-4">
                        <i data-lucide="save" class="w-5 h-5 inline mr-2"></i>Save All Changes
                    </button>
                </div>

                <!-- Payments Tab -->
                <div id="admin-content-payments" class="admin-content hidden">
                    <div class="bg-white rounded-lg shadow p-6">
                        <h2 class="text-xl font-bold mb-4">PayFast Settings</h2>
                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium mb-2">Payment Confirmation Email</label>
                                <input id="payment-email-admin" type="email" value="illuminatiegn@gmail.com" class="input-field">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Bank Account Details</label>
                                <textarea id="bank-details" class="input-field">TymeBank Everyday Account: 5110 3334 333</textarea>
                            </div>
                        </div>
                        <button onclick="saveAllSettings()" class="w-full mt-6 btn-primary">
                            <i data-lucide="save" class="w-4 h-4 inline mr-2"></i>Save Payment Settings
                        </button>
                    </div>
                </div>

                <!-- General Tab -->
                <div id="admin-content-general" class="admin-content hidden">
                    <div class="bg-white rounded-lg shadow p-6">
                        <h2 class="text-xl font-bold mb-4">General Settings</h2>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium mb-2">Footer Copyright</label>
                                <input id="copyright-text" value="© 2024 Illuminati Elite Global Network. All Rights Reserved." class="input-field">
                            </div>
                        </div>
                        <button onclick="saveAllSettings()" class="w-full mt-6 btn-primary">
                            <i data-lucide="save" class="w-4 h-4 inline mr-2"></i>Save General Settings
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Home Page -->
        <div id="home-page">
            <div class="absolute top-4 right-4 z-20">
                <button onclick="showAdminLogin()" class="text-gray-400 hover:text-gray-900 p-2 rounded-full hover:bg-gray-100">
                    <i data-lucide="settings" class="w-5 h-5"></i>
                </button>
            </div>
            
            <header class="relative text-center pt-20 pb-16 bg-white">
                <div class="relative z-10">
                    <img src="https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/68d179b3a460005e70e6ffea/c7c0219f9_IlluminatiEyewithSouthAfricanFlag.png" 
                         alt="Illuminati Logo" class="w-auto h-28 md:h-32 mx-auto object-contain mb-4">
                    <h1 class="text-4xl md:text-5xl font-extrabold text-gray-900 tracking-tight">Join The Illuminati</h1>
                    <p class="text-lg text-gray-600 max-w-2xl mx-auto mt-4 leading-relaxed px-4">
                        Transcend the mundane. Unlock your potential. Choose your path to enlightenment and join the most exclusive network on Earth.
                    </p>
                </div>
            </header>

            <main class="py-12 bg-gray-50/70">
                <div class="container mx-auto px-4">
                    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8 max-w-7xl mx-auto">
                        <!-- ADEPT Position -->
                        <div class="membership-card h-full flex flex-col group cursor-pointer" onclick="selectMembership('adept')">
                            <div class="relative">
                                <img id="home-adept-image" src="https://i.postimg.cc/MT2HTNhc/Screenshot-2025-11-06-160855.png" 
                                     alt="ADEPT" class="w-full h-40 object-cover rounded-t-xl">
                                <div class="absolute top-3 left-3 bg-black/70 text-white text-xs font-bold uppercase px-2 py-1 rounded-full">Entry Level</div>
                            </div>
                            <div class="p-6 flex flex-col flex-grow">
                                <h3 class="text-xl font-bold text-gray-900 mb-2">ADEPT Position</h3>
                                <div class="flex items-baseline gap-2 text-gray-800 mb-4">
                                    <i data-lucide="tag" class="w-4 h-4 text-gray-500"></i>
                                    <span class="text-2xl font-extrabold">R700</span>
                                    <span class="text-sm text-gray-500">Joining Fee</span>
                                </div>
                                <div class="space-y-3 text-sm mb-6 flex-grow">
                                    <div class="flex items-start gap-2">
                                        <i data-lucide="check" class="w-5 h-5 text-blue-600 flex-shrink-0"></i>
                                        <span>Access only EGN people</span>
                                    </div>
                                    <div class="flex items-start gap-2">
                                        <i data-lucide="check" class="w-5 h-5 text-blue-600 flex-shrink-0"></i>
                                        <span>Earn by members you put in the Illuminati EGN</span>
                                    </div>
                                    <div class="flex items-start gap-2">
                                        <i data-lucide="check" class="w-5 h-5 text-blue-600 flex-shrink-0"></i>
                                        <span>Monthly Income R250,000 - R300,000</span>
                                    </div>
                                </div>
                                <button class="w-full mt-auto btn-primary">
                                    Pay R700 Joining Fee
                                </button>
                            </div>
                        </div>

                        <!-- ILLUMINATIUM Position -->
                        <div class="membership-card h-full flex flex-col group cursor-pointer" onclick="selectMembership('illuminatium')">
                            <div class="relative">
                                <img id="home-illuminatium-image" src="https://i.postimg.cc/q7DpWYGJ/Screenshot-2025-11-06-164756.png" 
                                     alt="ILLUMINATIUM" class="w-full h-40 object-cover rounded-t-xl">
                                <div class="absolute top-3 left-3 bg-black/70 text-white text-xs font-bold uppercase px-2 py-1 rounded-full">Portal Manager</div>
                            </div>
                            <div class="p-6 flex flex-col flex-grow">
                                <h3 class="text-xl font-bold text-gray-900 mb-2">ILLUMINATIUM Position</h3>
                                <div class="flex items-baseline gap-2 text-gray-800 mb-4">
                                    <i data-lucide="tag" class="w-4 h-4 text-gray-500"></i>
                                    <span class="text-2xl font-extrabold">R1,000</span>
                                    <span class="text-sm text-gray-500">Joining Fee</span>
                                </div>
                                <div class="space-y-3 text-sm mb-6 flex-grow">
                                    <div class="flex items-start gap-2">
                                        <i data-lucide="check" class="w-5 h-5 text-blue-600 flex-shrink-0"></i>
                                        <span>Access the ILLUMINATI EGN portals to prepare EGN daily posts and marketing</span>
                                    </div>
                                    <div class="flex items-start gap-2">
                                        <i data-lucide="check" class="w-5 h-5 text-blue-600 flex-shrink-0"></i>
                                        <span>Earn by Creating and marketing templates and posting for EGN</span>
                                    </div>
                                    <div class="flex items-start gap-2">
                                        <i data-lucide="check" class="w-5 h-5 text-blue-600 flex-shrink-0"></i>
                                        <span>Monthly INCOME R340,000 - R710,000</span>
                                    </div>
                                </div>
                                <button class="w-full mt-auto btn-primary">
                                    Pay R1,000 Joining Fee
                                </button>
                            </div>
                        </div>

                        <!-- Influencer -->
                        <div class="membership-card h-full flex flex-col group cursor-pointer" onclick="selectMembership('influencer')">
                            <div class="relative">
                                <img id="home-influencer-image" src="https://i.postimg.cc/Btf11w2Y/istockphoto-2176715152-612x612.jpg" 
                                     alt="Influencer" class="w-full h-40 object-cover rounded-t-xl">
                                <div class="absolute top-3 left-3 bg-black/70 text-white text-xs font-bold uppercase px-2 py-1 rounded-full">Elite Circle</div>
                            </div>
                            <div class="p-6 flex flex-col flex-grow">
                                <h3 class="text-xl font-bold text-gray-900 mb-2">Influencer</h3>
                                <div class="flex items-baseline gap-2 text-gray-800 mb-4">
                                    <i data-lucide="tag" class="w-4 h-4 text-gray-500"></i>
                                    <span class="text-2xl font-extrabold">R1,500</span>
                                    <span class="text-sm text-gray-500">Joining Fee</span>
                                </div>
                                <div class="space-y-3 text-sm mb-6 flex-grow">
                                    <div class="flex items-start gap-2">
                                        <i data-lucide="check" class="w-5 h-5 text-blue-600 flex-shrink-0"></i>
                                        <span>Access influencer position and EGN portals, EGN cars to fetch new members and EGN devices to talk to people and Benefits for cars, house to stay, welcome funds all purchased by EGN for you</span>
                                    </div>
                                    <div class="flex items-start gap-2">
                                        <i data-lucide="check" class="w-5 h-5 text-blue-600 flex-shrink-0"></i>
                                        <span>Earn by fetching members and introducing members on the app and society or worshiping illuminati forces at 21h00</span>
                                    </div>
                                    <div class="flex items-start gap-2">
                                        <i data-lucide="check" class="w-5 h-5 text-blue-600 flex-shrink-0"></i>
                                        <span>Earnings: Daily earnings per Worship R2,355,000.99 DONE 5 TIMES A week and R510,000 for bring 3 members a day</span>
                                    </div>
                                </div>
                                <button class="w-full mt-auto btn-primary">
                                    Pay R1,500 Joining Fee
                                </button>
                            </div>
                        </div>

                        <!-- Full Worshiper -->
                        <div class="membership-card h-full flex flex-col group cursor-pointer" onclick="selectMembership('full_worshiper')">
                            <div class="relative">
                                <img id="home-worshiper-image" src="https://i.postimg.cc/D091Pz3c/istockphoto-508068250-612x612.jpg" 
                                     alt="Full Worshiper" class="w-full h-40 object-cover rounded-t-xl">
                                <div class="absolute top-3 left-3 bg-black/70 text-white text-xs font-bold uppercase px-2 py-1 rounded-full">Inner Circle</div>
                            </div>
                            <div class="p-6 flex flex-col flex-grow">
                                <h3 class="text-xl font-bold text-gray-900 mb-2">Full Worshiper</h3>
                                <div class="flex items-baseline gap-2 text-gray-800 mb-4">
                                    <i data-lucide="tag" class="w-4 h-4 text-gray-500"></i>
                                    <span class="text-2xl font-extrabold">R10,000</span>
                                    <span class="text-sm text-gray-500">Joining Fee</span>
                                </div>
                                <div class="space-y-3 text-sm mb-6 flex-grow">
                                    <div class="flex items-start gap-2">
                                        <i data-lucide="check" class="w-5 h-5 text-blue-600 flex-shrink-0"></i>
                                        <span>Access ceremonies management and priest position unlimited reward no limit on what you choose</span>
                                    </div>
                                    <div class="flex items-start gap-2">
                                        <i data-lucide="check" class="w-5 h-5 text-blue-600 flex-shrink-0"></i>
                                        <span>Earn by leading the ceremonies and ordering benefits like cars and houses goats for new members</span>
                                    </div>
                                    <div class="flex items-start gap-2">
                                        <i data-lucide="check" class="w-5 h-5 text-blue-600 flex-shrink-0"></i>
                                        <span>Earnings unlimited above R60,454,545 weekly counted by ceremonies you hosted</span>
                                    </div>
                                </div>
                                <button class="w-full mt-auto btn-primary">
                                    Pay R10,000 Joining Fee
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </main>

            <!-- Ceremony Gallery Section -->
            <div class="py-12 md:py-20 bg-white">
                <div class="container mx-auto px-4">
                    <div class="text-center mb-12">
                        <h2 class="text-3xl md:text-4xl font-bold text-gray-900">Glimpses of Our Ceremonies</h2>
                        <p class="text-lg text-gray-600 mt-2 max-w-2xl mx-auto">Witness the sacred gatherings that bind our members in unity and power.</p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="home-ceremonies-gallery"></div>
                </div>
            </div>

            <!-- Testimonials Section -->
            <div class="py-12 md:py-20 bg-gray-50/70">
                <div class="container mx-auto px-4">
                    <div class="text-center mb-12">
                        <h2 class="text-3xl md:text-4xl font-bold text-gray-900">Voices from the Inner Circle</h2>
                        <p class="text-lg text-gray-600 mt-2 max-w-2xl mx-auto">Hear from those who have embraced the light and found their true potential.</p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="home-testimonials"></div>

                    <!-- Attorney Section -->
                    <div class="mt-20">
                        <div class="bg-white border-gray-100 rounded-xl shadow-lg p-8 md:p-12 md:flex items-center gap-8 text-center md:text-left">
                            <i data-lucide="shield" class="w-20 h-20 text-blue-500 flex-shrink-0 mx-auto md:mx-0 mb-6 md:mb-0"></i>
                            <div>
                                <h3 id="attorney-title" class="text-2xl font-bold text-gray-900 mb-2">Our Commitment to Secrecy</h3>
                                <p id="attorney-text" class="text-gray-600 leading-relaxed">Your ascension into the Illuminati is a sacred pact. Every application, every correspondence, and your very identity are shielded by layers of digital and legal protection, ensuring your journey with us remains in absolute confidence.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <footer class="bg-gray-50 border-t border-gray-200">
                <div class="container mx-auto px-6 py-8">
                    <div class="text-center">
                        <img src="https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/68d179b3a460005e70e6ffea/c7c0219f9_IlluminatiEyewithSouthAfricanFlag.png" 
                             alt="Logo" class="w-auto h-16 object-contain mx-auto mb-4">
                        <p id="footer-copyright" class="text-sm text-gray-500">© 2024 Illuminati Elite Global Network. All Rights Reserved.</p>
                        <div class="flex items-center justify-center gap-2 mt-2">
                            <i data-lucide="mail" class="w-4 h-4 text-gray-600"></i>
                            <span id="footer-email" class="text-gray-600">illuminatiegn@gmail.com</span>
                        </div>
                        <div class="flex items-center justify-center gap-2 mt-2">
                            <i data-lucide="map-pin" class="w-4 h-4 text-gray-600"></i>
                            <span class="text-gray-600">Gauteng, Randburg, George AVE Street</span>
                        </div>
                    </div>
                </div>
            </footer>
        </div>

        <!-- Registration Form -->
        <div id="registration-page" class="hidden min-h-screen flex items-center justify-center p-4 bg-gray-50">
            <div class="max-w-2xl w-full">
                <div class="text-center mb-8">
                    <img src="https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/68d179b3a460005e70e6ffea/c7c0219f9_IlluminatiEyewithSouthAfricanFlag.png" 
                         alt="Logo" class="w-auto h-32 mx-auto mb-4">
                    <h1 class="text-4xl font-bold text-gray-900 mb-4">INITIATION REGISTRATION</h1>
                    <p class="text-gray-600 mb-2">Selected: <span id="selected-membership" class="text-gray-900 font-semibold"></span></p>
                    <p class="text-gray-700">Fee: <span id="selected-price" class="text-gray-900 font-bold"></span></p>
                </div>
                
                <div class="bg-white border border-gray-200 shadow-lg rounded-lg p-8">
                    <h2 class="text-2xl font-bold text-gray-900 text-center mb-6">Provide Your Details</h2>
                    <form id="registration-form" class="space-y-6">
                        <div class="space-y-2">
                            <label class="text-gray-700 flex items-center gap-2 font-medium">
                                <i data-lucide="user" class="w-4 h-4 text-gray-600"></i>Full Name
                            </label>
                            <input id="full_name" required placeholder="Enter your complete name" class="input-field">
                        </div>
                        
                        <div class="space-y-2">
                            <label class="text-gray-700 flex items-center gap-2 font-medium">
                                <i data-lucide="mail" class="w-4 h-4 text-gray-600"></i>Email Address
                            </label>
                            <input id="email" type="email" required placeholder="your.email@domain.com" class="input-field">
                        </div>
                        
                        <div class="space-y-2">
                            <label class="text-gray-700 flex items-center gap-2 font-medium">
                                <i data-lucide="phone" class="w-4 h-4 text-gray-600"></i>Phone Number
                            </label>
                            <input id="phone" required placeholder="+27 XX XXX XXXX" class="input-field">
                        </div>
                        
                        <div class="space-y-2">
                            <label class="text-gray-700 flex items-center gap-2 font-medium">
                                <i data-lucide="map-pin" class="w-4 h-4 text-gray-600"></i>Full Location/Address
                            </label>
                            <textarea id="location" required placeholder="City, Province/State, Country" class="input-field"></textarea>
                        </div>
                        
                        <div class="flex gap-4 pt-6">
                            <button type="button" onclick="showPage('home')" class="flex-1 border-gray-300 text-gray-600 hover:bg-gray-100 py-3 rounded-lg border font-semibold">
                                <i data-lucide="arrow-left" class="w-4 h-4 inline mr-2"></i>Back
                            </button>
                            <button type="submit" class="flex-1 bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded-lg">
                                PAY NOW VIA PAYFAST
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Admin Login Modal -->
        <div id="admin-login-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-lg p-6 max-w-md w-full mx-4">
                <h2 class="text-xl font-bold mb-4">Admin Access</h2>
                <input id="admin-password" type="password" placeholder="Enter password" class="input-field mb-4">
                <div class="flex gap-2">
                    <button onclick="closeAdminLogin()" class="flex-1 py-2 border rounded hover:bg-gray-100">Cancel</button>
                    <button onclick="checkAdminPassword()" class="flex-1 py-2 bg-gray-900 text-white rounded hover:bg-gray-800">Login</button>
                </div>
            </div>
        </div>

        <!-- Success Modal -->
        <div id="success-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-lg p-8 max-w-md w-full mx-4 text-center">
                <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i data-lucide="check-circle" class="w-12 h-12 text-green-600"></i>
                </div>
                <h2 class="text-2xl font-bold mb-2">Payment Successful!</h2>
                <p class="text-gray-600 mb-6">Your membership will be activated within 24-48 hours. Check your email for confirmation.</p>
                <button onclick="closeSuccessModal()" class="btn-primary w-full">Continue</button>
            </div>
        </div>
    </div>

    <script>
        // ===== FIREBASE CONFIGURATION =====
        const firebaseConfig = {
            apiKey: "AIzaSyDDMsvRTz9nPGDk8Ob_FPRc5Boov2FVt9w",
            authDomain: "egn-portal.firebaseapp.com",
            projectId: "egn-portal",
            storageBucket: "egn-portal.firebasestorage.app",
            messagingSenderId: "88252271549",
            appId: "1:88252271549:web:80aa211a420e205c1720d4",
            measurementId: "G-KYMBME9RDQ"
        };
        
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        
        // ===== PAYFAST CONFIGURATION =====
        const PAYFAST_MERCHANT_ID = '32909125';
        const PAYFAST_MERCHANT_KEY = 'zap68mi7ptd9l';
        const PAYFAST_URL = 'https://www.payfast.co.za/eng/process';
        const PAYFAST_RETURN_URL = 'https://zapk1.github.io/egnportal/?payment=success';
        const PAYFAST_CANCEL_URL = 'https://zapk1.github.io/egnportal/?payment=cancelled';
        
        // ===== DEFAULT DATA (5 TESTIMONIALS, 5 CEREMONIES) =====
        const DEFAULT_TESTIMONIALS = [
            {
                id: 'default-1',
                name: 'Marcus van der Berg',
                title: 'Tech Entrepreneur',
                quote: 'Joining the Illuminati transformed my business. The connections and wisdom I gained are invaluable.',
                image_url: 'https://i.postimg.cc/MTFcVYND/businessman-1.jpg',
                isDefault: true
            },
            {
                id: 'default-2',
                name: 'Thandi Mthembu',
                title: 'Investment Banker',
                quote: 'The network opened doors I never knew existed. My wealth and influence have grown exponentially.',
                image_url: 'https://i.postimg.cc/QxTJ8KgZ/businesswoman-1.jpg',
                isDefault: true
            },
            {
                id: 'default-3',
                name: 'David Nkosi',
                title: 'Real Estate Mogul',
                quote: 'The ancient knowledge and modern strategies combined have made me unstoppable in my industry.',
                image_url: 'https://i.postimg.cc/nhZvgLpY/businessman-2.jpg',
                isDefault: true
            },
            {
                id: 'default-4',
                name: 'Sarah Johnson',
                title: 'Fashion Designer',
                quote: 'Being part of the Inner Circle gave me access to global markets and elite clientele beyond imagination.',
                image_url: 'https://i.postimg.cc/Kz8pG7Yf/businesswoman-2.jpg',
                isDefault: true
            },
            {
                id: 'default-5',
                name: 'Ahmed Patel',
                title: 'Media Executive',
                quote: 'The Illuminati network is real power. My influence spans continents now.',
                image_url: 'https://i.postimg.cc/yx3DjH8Q/businessman-3.jpg',
                isDefault: true
            }
        ];

        const DEFAULT_CEREMONIES = [
            {
                id: 'ceremony-1',
                title: 'The Grand Initiation',
                description: 'New members taking their sacred oath under the watchful eye',
                image_url: 'https://i.postimg.cc/ZK8xW9Qd/ceremony-1.jpg',
                isDefault: true
            },
            {
                id: 'ceremony-2',
                title: 'Annual Summit 2024',
                description: 'Global leaders gathering for the annual enlightenment summit',
                image_url: 'https://i.postimg.cc/QMnX7KjP/ceremony-2.jpg',
                isDefault: true
            },
            {
                id: 'ceremony-3',
                title: 'The Sacred Circle',
                description: 'Inner circle members performing the ancient ritual of wisdom',
                image_url: 'https://i.postimg.cc/yx9hT6mK/ceremony-3.jpg',
                isDefault: true
            },
            {
                id: 'ceremony-4',
                title: 'Wealth Manifestation Ceremony',
                description: 'Members channeling prosperity and abundance energies',
                image_url: 'https://i.postimg.cc/DzNr4vWq/ceremony-4.jpg',
                isDefault: true
            },
            {
                id: 'ceremony-5',
                title: 'Elite Network Gathering',
                description: 'Global elite members connecting and sharing knowledge',
                image_url: 'https://i.postimg.cc/yNQp1xZv/ceremony-5.jpg',
                isDefault: true
            }
        ];
        
        // ===== APPLICATION STATE =====
        let AppState = {
            currentPage: 'home',
            selectedMembership: null,
            selectedMembershipKey: null,
            memberData: null,
            isAdmin: false,
            adminSettings: {
                payment_email: "illuminatiegn@gmail.com",
                bank_details: "TymeBank Everyday Account: 5110 3334 333",
                adept_image_url: "https://i.postimg.cc/MT2HTNhc/Screenshot-2025-11-06-160855.png",
                illuminatium_image_url: "https://i.postimg.cc/q7DpWYGJ/Screenshot-2025-11-06-164756.png",
                influencer_image_url: "https://i.postimg.cc/Btf11w2Y/istockphoto-2176715152-612x612.jpg",
                worshiper_image_url: "https://i.postimg.cc/D091Pz3c/istockphoto-508068250-612x612.jpg",
                copyright_text: "© 2024 Illuminati Elite Global Network. All Rights Reserved.",
                initiations_hosted: 137,
                next_members_count: 2500,
                attorney_section_title: "Our Commitment to Secrecy",
                attorney_section_text: "Your ascension into the Illuminati is a sacred pact. Every application, every correspondence, and your very identity are shielded by layers of digital and legal protection, ensuring your journey with us remains in absolute confidence."
            },
            testimonials: [],
            ceremonies: []
        };
        
        const memberships = {
            adept: { title: 'ADEPT Position', price: 'R700', amount: 700 },
            illuminatium: { title: 'ILLUMINATIUM Position', price: 'R1,000', amount: 1000 },
            influencer: { title: 'Influencer', price: 'R1,500', amount: 1500 },
            full_worshiper: { title: 'Full Worshiper', price: 'R10,000', amount: 10000 }
        };

        // ===== FIREBASE FUNCTIONS =====
        async function loadTestimonialsFromFirebase() {
            try {
                const snapshot = await db.collection('testimonials').get();
                const firebaseTestimonials = snapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data(),
                    isDefault: false
                }));
                
                AppState.testimonials = [...DEFAULT_TESTIMONIALS, ...firebaseTestimonials];
                refreshTestimonialsDisplay();
            } catch (error) {
                console.error('Error loading testimonials:', error);
                AppState.testimonials = DEFAULT_TESTIMONIALS;
                refreshTestimonialsDisplay();
            }
        }

        async function loadCeremoniesFromFirebase() {
            try {
                const snapshot = await db.collection('ceremonies').get();
                const firebaseCeremonies = snapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data(),
                    isDefault: false
                }));
                
                AppState.ceremonies = [...DEFAULT_CEREMONIES, ...firebaseCeremonies];
                refreshCeremoniesDisplay();
            } catch (error) {
                console.error('Error loading ceremonies:', error);
                AppState.ceremonies = DEFAULT_CEREMONIES;
                refreshCeremoniesDisplay();
            }
        }

        async function addTestimonial() {
            const name = document.getElementById('new-testimonial-name').value.trim();
            const title = document.getElementById('new-testimonial-title').value.trim();
            const quote = document.getElementById('new-testimonial-quote').value.trim();
            const image = document.getElementById('new-testimonial-image').value.trim();
            
            if (!name || !title || !quote) {
                showToast('Please fill all testimonial fields', 'error');
                return;
            }
            
            const testimonialData = {
                name: name,
                title: title,
                quote: quote,
                image_url: image || 'https://via.placeholder.com/150',
                created_at: firebase.firestore.FieldValue.serverTimestamp()
            };
            
            try {
                await db.collection('testimonials').add(testimonialData);
                
                // Clear form
                document.getElementById('new-testimonial-name').value = '';
                document.getElementById('new-testimonial-title').value = '';
                document.getElementById('new-testimonial-quote').value = '';
                document.getElementById('new-testimonial-image').value = '';
                
                showToast('✅ Testimonial added successfully!', 'success');
                await loadTestimonialsFromFirebase();
            } catch (error) {
                console.error('Error adding testimonial:', error);
                showToast('❌ Failed to add testimonial', 'error');
            }
        }

        async function removeTestimonial(id, isDefault) {
            if (isDefault) {
                showToast('❌ Cannot delete default testimonials', 'error');
                return;
            }
            
            if (!confirm('Are you sure you want to delete this testimonial?')) return;
            
            try {
                await db.collection('testimonials').doc(id).delete();
                showToast('✅ Testimonial deleted!', 'success');
                await loadTestimonialsFromFirebase();
            } catch (error) {
                console.error('Error removing testimonial:', error);
                showToast('❌ Failed to delete testimonial', 'error');
            }
        }

        async function addCeremony() {
            const title = document.getElementById('new-ceremony-title').value.trim();
            const description = document.getElementById('new-ceremony-description').value.trim();
            const image = document.getElementById('new-ceremony-image').value.trim();
            
            if (!title || !image) {
                showToast('Please provide title and image URL', 'error');
                return;
            }
            
            const ceremonyData = {
                title: title,
                description: description || '',
                image_url: image,
                created_at: firebase.firestore.FieldValue.serverTimestamp()
            };
            
            try {
                await db.collection('ceremonies').add(ceremonyData);
                
                // Clear form
                document.getElementById('new-ceremony-title').value = '';
                document.getElementById('new-ceremony-description').value = '';
                document.getElementById('new-ceremony-image').value = '';
                
                showToast('✅ Ceremony photo added successfully!', 'success');
                await loadCeremoniesFromFirebase();
            } catch (error) {
                console.error('Error adding ceremony:', error);
                showToast('❌ Failed to add ceremony photo', 'error');
            }
        }

        async function removeCeremony(id, isDefault) {
            if (isDefault) {
                showToast('❌ Cannot delete default ceremonies', 'error');
                return;
            }
            
            if (!confirm('Are you sure you want to delete this ceremony photo?')) return;
            
            try {
                await db.collection('ceremonies').doc(id).delete();
                showToast('✅ Ceremony photo deleted!', 'success');
                await loadCeremoniesFromFirebase();
            } catch (error) {
                console.error('Error removing ceremony:', error);
                showToast('❌ Failed to delete ceremony photo', 'error');
            }
        }

        function refreshTestimonialsDisplay() {
            // Admin list
            const list = document.getElementById('testimonials-list');
            if (list) {
                const firebaseOnly = AppState.testimonials.filter(t => !t.isDefault);
                list.innerHTML = firebaseOnly.length === 0 
                    ? '<p class="text-gray-500 text-sm">No custom testimonials yet. Add one above!</p>'
                    : firebaseOnly.map(t => `
                        <div class="flex items-center justify-between bg-gray-50 p-3 rounded-md border">
                            <div class="flex items-center gap-3">
                                <img src="${t.image_url}" class="w-10 h-10 rounded-full object-cover"/>
                                <div>
                                    <p class="font-semibold text-sm">${t.name}</p>
                                    <p class="text-xs text-gray-500">${t.title}</p>
                                </div>
                            </div>
                            <button onclick="removeTestimonial('${t.id}', ${t.isDefault})" class="text-red-500 hover:bg-red-50 p-2 rounded">
                                <i data-lucide="trash-2" class="w-4 h-4"></i>
                            </button>
                        </div>
                    `).join('');
            }
            
            // Homepage display (all testimonials)
            const homeTestimonials = document.getElementById('home-testimonials');
            if (homeTestimonials) {
                homeTestimonials.innerHTML = AppState.testimonials.map(t => `
                    <div class="bg-white border border-gray-100 rounded-xl shadow-lg p-6 text-center h-full">
                        <img src="${t.image_url}" alt="${t.name}" class="w-24 h-24 rounded-full object-cover mx-auto mb-4 border-4 border-white shadow-md">
                        <h3 class="text-xl font-bold text-gray-900">${t.name}</h3>
                        <p class="inline-block bg-blue-100 text-blue-800 text-xs font-semibold px-3 py-1 rounded-full my-2">${t.title}</p>
                        <blockquote class="text-gray-600 italic mt-4 text-sm">"${t.quote}"</blockquote>
                    </div>
                `).join('');
            }
            
            lucide.createIcons();
        }

        function refreshCeremoniesDisplay() {
            // Admin list
            const list = document.getElementById('ceremonies-list');
            if (list) {
                const firebaseOnly = AppState.ceremonies.filter(c => !c.isDefault);
                list.innerHTML = firebaseOnly.length === 0
                    ? '<p class="text-gray-500 text-sm">No custom ceremony photos yet. Add one above!</p>'
                    : firebaseOnly.map(c => `
                        <div class="flex items-center justify-between bg-gray-50 p-3 rounded-md border">
                            <div class="flex items-center gap-3">
                                <img src="${c.image_url}" class="w-16 h-10 rounded object-cover"/>
                                <div>
                                    <p class="font-semibold text-sm">${c.title}</p>
                                    <p class="text-xs text-gray-500">${c.description}</p>
                                </div>
                            </div>
                            <button onclick="removeCeremony('${c.id}', ${c.isDefault})" class="text-red-500 hover:bg-red-50 p-2 rounded">
                                <i data-lucide="trash-2" class="w-4 h-4"></i>
                            </button>
                        </div>
                    `).join('');
            }
            
            // Homepage gallery (all ceremonies)
            const homeGallery = document.getElementById('home-ceremonies-gallery');
            if (homeGallery) {
                homeGallery.innerHTML = AppState.ceremonies.map(c => `
                    <div class="bg-white border border-gray-100 overflow-hidden shadow-md hover:shadow-xl transition-shadow duration-300 rounded-xl">
                        <div class="relative overflow-hidden h-64">
                            <img src="${c.image_url}" alt="${c.title}" class="w-full h-full object-cover hover:scale-105 transition-transform duration-500">
                            <div class="absolute inset-0 bg-black/20"></div>
                        </div>
                        <div class="p-6 bg-white">
                            <h3 class="text-xl font-bold text-gray-900 mb-2">${c.title}</h3>
                            <p class="text-gray-600 text-sm">${c.description}</p>
                        </div>
                    </div>
                `).join('');
            }
            
            lucide.createIcons();
        }

        // ===== UTILITY FUNCTIONS =====
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = 'toast' + (type === 'error' ? ' error' : '');
            toast.textContent = message;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }

        function showPage(pageId) {
            document.querySelectorAll('#app-container > div').forEach(p => p.classList.add('hidden'));
            document.getElementById(pageId + '-page').classList.remove('hidden');
            AppState.currentPage = pageId;
            lucide.createIcons();
        }

        function selectMembership(id) {
            AppState.selectedMembership = memberships[id];
            AppState.selectedMembershipKey = id;
            document.getElementById('selected-membership').textContent = AppState.selectedMembership.title;
            document.getElementById('selected-price').textContent = AppState.selectedMembership.price;
            showPage('registration');
        }

        function showAdminLogin() {
            document.getElementById('admin-login-modal').classList.remove('hidden');
        }

        function closeAdminLogin() {
            document.getElementById('admin-login-modal').classList.add('hidden');
            document.getElementById('admin-password').value = '';
        }

        async function checkAdminPassword() {
            const password = document.getElementById('admin-password').value;
            if (password === 'VNAXXTTM') {
                AppState.isAdmin = true;
                closeAdminLogin();
                showPage('admin');
                initializeAdminFields();
                showAdminTab('homepage');
                await loadTestimonialsFromFirebase();
                await loadCeremoniesFromFirebase();
            } else {
                showToast('❌ Invalid password', 'error');
            }
        }

        function showAdminTab(tabId) {
            document.querySelectorAll('.admin-content').forEach(content => content.classList.add('hidden'));
            document.querySelectorAll('.tab-button').forEach(tab => tab.classList.remove('active'));
            document.getElementById('admin-content-' + tabId).classList.remove('hidden');
            document.getElementById('admin-tab-' + tabId).classList.add('active');
            lucide.createIcons();
        }

        function initializeAdminFields() {
            document.getElementById('payment-email-admin').value = AppState.adminSettings.payment_email;
            document.getElementById('bank-details').value = AppState.adminSettings.bank_details;
            document.getElementById('copyright-text').value = AppState.adminSettings.copyright_text;
            document.getElementById('initiations-hosted').value = AppState.adminSettings.initiations_hosted;
            document.getElementById('next-members-count').value = AppState.adminSettings.next_members_count;
            document.getElementById('attorney-section-title').value = AppState.adminSettings.attorney_section_title;
            document.getElementById('attorney-section-text').value = AppState.adminSettings.attorney_section_text;
            
            updateImagePreview('adept', AppState.adminSettings.adept_image_url);
            updateImagePreview('illuminatium', AppState.adminSettings.illuminatium_image_url);
            updateImagePreview('influencer', AppState.adminSettings.influencer_image_url);
            updateImagePreview('worshiper', AppState.adminSettings.worshiper_image_url);
        }

        function updateImagePreview(type, url) {
            const preview = document.getElementById(type + '-image-preview');
            if (preview) {
                preview.innerHTML = url ? `<img src="${url}" class="w-full h-48 object-cover rounded">` : '';
            }
            const homeImage = document.getElementById('home-' + type + '-image');
            if (homeImage) homeImage.src = url || 'https://via.placeholder.com/800x400';
            AppState.adminSettings[type + '_image_url'] = url;
            lucide.createIcons();
        }

        function saveAllSettings() {
            AppState.adminSettings.payment_email = document.getElementById('payment-email-admin').value;
            AppState.adminSettings.copyright_text = document.getElementById('copyright-text').value;
            AppState.adminSettings.bank_details = document.getElementById('bank-details').value;
            AppState.adminSettings.adept_image_url = document.getElementById('adept-image-url').value;
            AppState.adminSettings.illuminatium_image_url = document.getElementById('illuminatium-image-url').value;
            AppState.adminSettings.influencer_image_url = document.getElementById('influencer-image-url').value;
            AppState.adminSettings.worshiper_image_url = document.getElementById('worshiper-image-url').value;
            AppState.adminSettings.initiations_hosted = Number(document.getElementById('initiations-hosted').value);
            AppState.adminSettings.next_members_count = Number(document.getElementById('next-members-count').value);
            AppState.adminSettings.attorney_section_title = document.getElementById('attorney-section-title').value;
            AppState.adminSettings.attorney_section_text = document.getElementById('attorney-section-text').value;
            
            // Update live elements
            document.getElementById('footer-copyright').textContent = AppState.adminSettings.copyright_text;
            document.getElementById('footer-email').textContent = AppState.adminSettings.payment_email;
            document.getElementById('attorney-title').textContent = AppState.adminSettings.attorney_section_title;
            document.getElementById('attorney-text').textContent = AppState.adminSettings.attorney_section_text;
            
            // Save to localStorage for persistence
            localStorage.setItem('egn_admin_settings', JSON.stringify(AppState.adminSettings));
            
            showToast('✅ Settings saved successfully!', 'success');
            lucide.createIcons();
        }

        // ===== PAYFAST PAYMENT INTEGRATION =====
        function initiatePayFast(membershipKey, memberData) {
            const membership = memberships[membershipKey];
            const amount = membership.amount;
            const merchantPaymentId = 'EGN-' + Date.now();
            
            const nameParts = memberData.name.trim().split(' ');
            const firstName = nameParts[0];
            const lastName = nameParts.slice(1).join(' ') || firstName;
            const cleanPhone = memberData.phone.replace(/[\s\-\(\)]/g, '');
            
            const paymentData = {
                'merchant_id': PAYFAST_MERCHANT_ID,
                'merchant_key': PAYFAST_MERCHANT_KEY,
                'return_url': PAYFAST_RETURN_URL,
                'cancel_url': PAYFAST_CANCEL_URL,
                'notify_url': 'https://zapk1.github.io/egnportal/payfast-notify',
                'name_first': firstName,
                'name_last': lastName,
                'email_address': memberData.email,
                'cell_number': cleanPhone,
                'm_payment_id': merchantPaymentId,
                'amount': amount.toFixed(2),
                'item_name': membership.title,
                'item_description': 'Illuminati EGN ' + membership.title + ' Membership',
                'custom_str1': membershipKey,
                'custom_str2': memberData.location,
                'custom_str3': memberData.name
            };
            
            // Save payment attempt to Firestore
            db.collection('payment_attempts').add({
                ...paymentData,
                timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                status: 'pending'
            }).catch(err => console.error('Failed to log payment:', err));
            
            // Create and submit PayFast form
            const form = document.createElement('form');
            form.method = 'POST';
            form.action = PAYFAST_URL;
            
            for (let key in paymentData) {
                const input = document.createElement('input');
                input.type = 'hidden';
                input.name = key;
                input.value = paymentData[key];
                form.appendChild(input);
            }
            
            document.body.appendChild(form);
            showToast('🔄 Redirecting to PayFast secure payment...', 'success');
            
            setTimeout(() => {
                form.submit();
            }, 1000);
        }

        // ===== FORM SUBMISSION =====
        document.getElementById('registration-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            AppState.memberData = {
                name: document.getElementById('full_name').value.trim(),
                email: document.getElementById('email').value.trim(),
                phone: document.getElementById('phone').value.trim(),
                location: document.getElementById('location').value.trim()
            };
            
            if (!AppState.memberData.name || !AppState.memberData.email || !AppState.memberData.phone || !AppState.memberData.location) {
                showToast('❌ Please fill all fields', 'error');
                return;
            }
            
            // Save registration to Firestore
            try {
                await db.collection('registrations').add({
                    ...AppState.memberData,
                    membership: AppState.selectedMembership.title,
                    amount: AppState.selectedMembership.price,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    status: 'payment_pending'
                });
            } catch (error) {
                console.error('Error saving registration:', error);
            }
            
            if (confirm(`💳 Proceed to pay ${AppState.selectedMembership.price} via PayFast for ${AppState.selectedMembership.title}?\n\nYou will be redirected to a secure payment gateway.`)) {
                initiatePayFast(AppState.selectedMembershipKey, AppState.memberData);
            }
        });

        // ===== PAYMENT STATUS CHECK =====
        window.addEventListener('load', async function() {
            const urlParams = new URLSearchParams(window.location.search);
            const paymentStatus = urlParams.get('payment');
            
            if (paymentStatus === 'success') {
                document.getElementById('success-modal').classList.remove('hidden');
                window.history.replaceState({}, document.title, window.location.pathname);
                
                // Log successful payment
                try {
                    await db.collection('successful_payments').add({
                        timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                        status: 'completed'
                    });
                } catch (error) {
                    console.error('Failed to log success:', error);
                }
            } else if (paymentStatus === 'cancelled') {
                showToast('❌ Payment cancelled. You can try again anytime.', 'error');
                window.history.replaceState({}, document.title, window.location.pathname);
                showPage('home');
            }
            
            // Load saved settings
            const savedSettings = localStorage.getItem('egn_admin_settings');
            if (savedSettings) {
                AppState.adminSettings = {...AppState.adminSettings, ...JSON.parse(savedSettings)};
                document.getElementById('footer-copyright').textContent = AppState.adminSettings.copyright_text;
                document.getElementById('footer-email').textContent = AppState.adminSettings.payment_email;
                document.getElementById('attorney-title').textContent = AppState.adminSettings.attorney_section_title;
                document.getElementById('attorney-text').textContent = AppState.adminSettings.attorney_section_text;
                
                // Update images
                document.getElementById('home-adept-image').src = AppState.adminSettings.adept_image_url;
                document.getElementById('home-illuminatium-image').src = AppState.adminSettings.illuminatium_image_url;
                document.getElementById('home-influencer-image').src = AppState.adminSettings.influencer_image_url;
                document.getElementById('home-worshiper-image').src = AppState.adminSettings.worshiper_image_url;
            }
            
            // Load testimonials and ceremonies
            await loadTestimonialsFromFirebase();
            await loadCeremoniesFromFirebase();
            
            lucide.createIcons();
        });

        function closeSuccessModal() {
            document.getElementById('success-modal').classList.add('hidden');
            showPage('home');
        }
        
        // Initialize Lucide icons
        lucide.createIcons();
    </script>
</body>
</html>
